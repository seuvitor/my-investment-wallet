!function(e){var t={};function a(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=6)}([function(e,t){e.exports=React},function(e,t){e.exports=MaterialUI},function(e,t){e.exports=Big},function(e,t){e.exports=AWS},function(e,t){e.exports=ReactDOM},function(e,t){e.exports=uuidv4},function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(4),l=a.n(r),i=a(1);const s=o.a.createElement,{ThemeProvider:c}=i;var u=({children:e})=>{const[t]=o.a.useState(i.createMuiTheme({palette:{primary:{main:"#556cd6"}}}));return s(c,{theme:t},e)};const d=o.a.createElement,{Icon:p,IconButton:m,Snackbar:g}=i,y=o.a.createContext(),v=({children:e})=>{const[t,a]=o.a.useState([]),[n,r]=o.a.useState(void 0),[l,i]=o.a.useState(!1);o.a.useEffect(()=>{t.length&&!n?(r(t[0]),a(e=>e.slice(1)),i(!0)):t.length&&n&&l&&i(!1)},[t,n,l]);const s=o.a.useCallback(e=>{a(t=>[...t,e])},[]),c=(e,t)=>{"clickaway"!==t&&i(!1)};return d(y.Provider,{value:{showMessage:s}},e,d(g,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:l,autoHideDuration:5e3,onClose:c,onExited:()=>{r(void 0)},message:n,action:d(m,{color:"inherit",onClick:c},d(p,null,"close"))},null))};var h=y,f=a(3),b=a.n(f);const C="https://carteira-investimentos.auth.us-east-1.amazoncognito.com",x=C+"/oauth2/token",w="7s3vb9runcfjvgetrvhdfd97at",k="https://seuvitor.github.io/my-investment-wallet/?auth-redirect",I=`${C}/login?client_id=${w}&response_type=code&scope=email+openid+profile&redirect_uri=${k}`,E=o.a.createElement,P=o.a.createContext(),T=({children:e})=>{const[t,a]=o.a.useState({identityId:void 0,id:void 0,name:void 0,email:void 0,groups:void 0,idToken:void 0,accessToken:void 0}),[n,r]=o.a.useState(sessionStorage.getItem("my-investment-wallet-refresh-token")),[l,i]=o.a.useState(void 0),[s]=o.a.useState(15e5),[c,u]=o.a.useState(void 0);o.a.useEffect(()=>{n?sessionStorage.setItem("my-investment-wallet-refresh-token",n):sessionStorage.removeItem("my-investment-wallet-refresh-token")},[n]);const d=o.a.useCallback(()=>new Promise(e=>{a({identityId:void 0,id:void 0,name:void 0,email:void 0,groups:void 0,idToken:void 0,accessToken:void 0}),r(void 0),i(void 0),e()}),[]);o.a.useEffect(()=>{i(c?e=>e?(e.update({credentials:c}),e):new b.a.Config({region:"us-east-1",credentials:c}):void 0)},[c]);const p=o.a.useCallback((e,t)=>{const n=new b.a.CognitoIdentityCredentials({IdentityPoolId:"us-east-1:874c45d2-0eb6-4d04-92f0-b8769dcbcc54",...e&&{Logins:{"cognito-idp.us-east-1.amazonaws.com/us-east-1_SjfN8ExVX":e}}},{region:"us-east-1"});return new Promise((o,r)=>{n.clearCachedId(),n.getPromise().then(()=>{u(n),a(a=>{const o=e&&JSON.parse(atob(e.split(".")[1]));return a.identityId=n.identityId,a.id=o&&o.sub,a.name=o?o.name:"Usuário não logado",a.email=o&&o.email,a.groups=o&&o["cognito:groups"],a.idToken=e,a.accessToken=t,a}),o()}).catch(e=>{u(void 0),a({identityId:void 0,id:void 0,name:void 0,email:void 0,groups:void 0,idToken:void 0,accessToken:void 0}),console.warn("Could not validate credentials",e),r(e)})})},[]),m=o.a.useCallback(e=>new Promise((t,a)=>{e?fetch(x,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`grant_type=refresh_token&client_id=${w}&refresh_token=${e}`}).then(e=>{e.json().then(e=>{p(e.id_token,e.access_token).then(()=>{t()}).catch(e=>{console.error("Could not login with refreshed tokens",e),a(e)})}).catch(e=>{console.error("Could not decode authentication response",e),a(e)})}).catch(e=>{console.error("Could not get refreshed tokens",e),a(e)}):(console.warn("No refreshToken available"),a(new Error("No refreshToken available")))}),[p]);((e,t)=>{const a=o.a.useRef(),n=o.a.useCallback(()=>{const e=a.current;e&&(a.current=void 0,clearInterval(e))},[a]);o.a.useEffect(()=>(a.current=setInterval(e,t),n),[e,t,n])})(o.a.useCallback(()=>{m(n).catch(e=>{console.error("Could not refresh tokens",e)})},[n,m]),s);const g=o.a.useCallback(()=>p(),[p]),y=o.a.useCallback(e=>new Promise((t,a)=>{fetch(x,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`grant_type=authorization_code&client_id=${w}&code=${e}&redirect_uri=${k}`}).then(e=>{e.json().then(e=>{m(e.refresh_token).then(()=>{r(e.refresh_token),t()}).catch(e=>{console.error("Could not login with refreshed tokens",e),r(void 0),a(e)})}).catch(e=>{console.error("Could not decode authentication response",e),r(void 0),a(e)})}).catch(e=>{console.error("Could not get identification tokens with this authorization code",e),r(void 0),a(e)})}),[m]);return o.a.useEffect(()=>{n&&!c&&m(n).catch(e=>{console.error("Could not refresh tokens",e)})},[n,c,m]),E(P.Provider,{value:{user:t,awsConfig:l,awsCredentials:c,loginAnonymously:g,loginWithAuthorizationCode:y,logoff:d}},e)};var S=P;const D=o.a.createElement,A=o.a.createContext(),_=({children:e})=>{const{awsConfig:t,awsCredentials:a}=o.a.useContext(S),[n,r]=o.a.useState();return o.a.useEffect(()=>{r(t?new b.a.DynamoDB.DocumentClient(t):void 0)},[t]),o.a.useEffect(()=>{a&&r(e=>(e&&e.service.config.update({credentials:a}),e))},[a]),D(A.Provider,{value:{documentDB:n}},e)};var N=A;const B=o.a.createElement,O=o.a.createContext(),M=({children:e})=>{const{user:{accessToken:t},awsConfig:a,awsCredentials:n}=o.a.useContext(S),[r,l]=o.a.useState();o.a.useEffect(()=>{l(a?new b.a.Lambda(a):void 0)},[a]),o.a.useEffect(()=>{n&&l(e=>(e&&e.config.update({credentials:n}),e))},[n]);const i=o.a.useCallback((e,a)=>{const n={FunctionName:e,ClientContext:btoa(JSON.stringify({accessToken:t}))};return a&&(n.Payload=JSON.stringify(a)),new Promise((e,t)=>{r.invoke(n).promise().then(a=>{a.StatusCode&&200===a.StatusCode&&a.Payload||t(a);const n=JSON.parse(a.Payload);n&&n.statusCode&&200===n.statusCode||t(a),e(n.body)}).catch(e=>{t(e)})})},[r,t]);return B(O.Provider,{value:{invokeLambda:r&&i}},e)};var V=O;const F=o.a.createElement,{useLocation:z}=window.ReactRouterDOM,{AppBar:R,Button:j,Divider:L,Icon:$,IconButton:W,Menu:U,MenuItem:q,Toolbar:Q,Typography:G}=i,K=()=>{const{user:{name:e}}=o.a.useContext(S);return e?null:F(o.a.Fragment,null,F(j,{color:"inherit",href:I},"Login"))},H=()=>{const{showMessage:e}=o.a.useContext(h),{user:{name:t},logoff:a}=o.a.useContext(S),[n,r]=o.a.useState(!1),l=o.a.useRef(null);return t?F(o.a.Fragment,null,F(W,{color:"inherit",ref:l,onClick:()=>{r(!0)}},F($,null,"account_circle")),F(U,{open:n,onClose:()=>{r(!1)},anchorEl:l.current,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},F(q,{disabled:!0},t),F(L,null,null),F(q,{onClick:()=>{a().then(()=>{e("Usuário deslogado com sucesso")}).catch(t=>{e("Não foi possível deslogar o usuário"),console.error("Logoff failed",t)}),r(!1)}},"Logoff"))):null};var J=({setDrawerOpen:e,routes:t})=>{const a=z(),n=t.find(e=>e.path===a.pathname);return F(R,null,F(Q,null,F(W,{edge:"start",color:"inherit",onClick:()=>e(!0)},F($,null,"menu")),F(G,{style:{flexGrow:1}},n?n.label:""),F(K,null,null),F(H,null,null)))};const X=o.a.createElement,{NavLink:Y}=window.ReactRouterDOM,{Box:Z,Divider:ee,Drawer:te,Icon:ae,ListItem:ne,ListItemText:oe,Toolbar:re}=i;var le=({routes:e,drawerOpen:t,setDrawerOpen:a})=>{const{user:{groups:n}}=o.a.useContext(S),r=()=>a(!1);return X(te,{open:t,onClose:r},X(re,{onClick:r,style:{padding:"inherit"}},X(ne,{button:!0,style:{justifyContent:"space-between",height:"100%"}},X(Z,{style:{flex:"auto",textAlign:"center"}},X("img",{src:"https://d3oia8etllorh5.cloudfront.net/us-east-1_SjfN8ExVX/ALL/20200706011733/assets/images/image.jpg",width:"70px",height:"70px"},null)),X(ae,null,"chevron_left"))),X(ee,null,null),e.filter(e=>!e.hideFromMenu).filter(e=>{return!(t=e.authorizedGroups)||!!n&&t.some(e=>n.includes(e));var t}).map(e=>X(ne,{key:e.name+"-route-drawer-item",button:!0,component:Y,activeClassName:"Mui-selected",to:e.path,onClick:r,...e.options},X(oe,{primary:e.label},null))))};var ie=()=>{const{showMessage:e}=o.a.useContext(h),{user:{identityId:t}}=o.a.useContext(S),{invokeLambda:a}=o.a.useContext(V),n=o.a.useCallback(()=>new Promise((n,o)=>{a("update_asset_allocation",{user_id:t}).then(()=>{e("Portfólio atualizado com sucesso"),n()}).catch(t=>{e("Não foi possível atualizar o portfólio"),console.error("Portfolio update failed",t),o(t)})}),[e,t,a]),r=o.a.useCallback(()=>new Promise((o,r)=>{a("update_target_allocation",{user_id:t}).then(()=>{e("Macro-alocação atualizada com sucesso"),n().then(()=>{o()}).catch(e=>{r(e)})}).catch(t=>{e("Não foi possível atualizar a macro-alocação"),console.error("Target allocation update failed",t),r(t)})}),[e,t,a,n]),l=o.a.useCallback(()=>new Promise((o,r)=>{a("update_position",{user_id:t}).then(()=>{e("Posição atualizada com sucesso"),n().then(()=>{o()}).catch(e=>{r(e)})}).catch(t=>{e("Não foi possível atualizar a posição"),console.error("Position update failed",t),r(t)})}),[e,t,a,n]);return{updatePosition:a&&l,updateTargetAllocation:a&&r,updatePortofolio:a&&n}};const se=o.a.createElement,{Redirect:ce}=window.ReactRouterDOM;var ue=()=>{const{user:{identityId:e}}=o.a.useContext(S),{updatePortofolio:t}=ie();return o.a.useEffect(()=>{t&&t()},[t]),e?se(ce,{to:"/target-allocation"},null):null};const de=o.a.createElement,{useParams:pe,useHistory:me}=window.ReactRouterDOM,{Backdrop:ge,CircularProgress:ye}=i;var ve=()=>{const{showMessage:e}=o.a.useContext(h),{loginWithAuthorizationCode:t}=o.a.useContext(S),{authorization_code:a}=pe(),[n,r]=o.a.useState(!0),l=i.useTheme(),s=me();return o.a.useEffect(()=>{t(a).then(()=>{e("Usuário logado com sucesso"),s.replace("/")}).catch(t=>{e("Não foi possível completar o login"),console.error("Login failed",t),r(!1)})},[a,t,e,s]),de(ge,{open:n,style:{zIndex:1+l.zIndex.drawer}},de(ye,null,null))},he=a(2),fe=a.n(he);const be=async(e,t)=>{const a={TableName:"priced_position",Key:{user_id:t},AttributesToGet:["assets"]},n=await e.get(a).promise();return n.Item&&n.Item.assets||{}},Ce=async(e,t)=>{const a={TableName:"asset",Key:{user_id:t},AttributesToGet:["assets"]},n=await e.get(a).promise();return n.Item&&n.Item.assets||{}},xe=e=>e.startsWith("0")?"0":e.startsWith("1")?"1":e.startsWith("2")?"2":e[0]>="3"&&e[0]<="9"?"3-9":"a-z",we=async(e,t)=>{const a=[t];return(await(async(e,t)=>{const a=t.map(e=>xe(e)),n=[...new Set(a)];return(await Promise.all(n.map(a=>(async(e,t,a)=>{const n={TableName:"price",Key:{partition:t},ProjectionExpression:a.map((e,t)=>"prices.#"+t).join(","),ExpressionAttributeNames:a.reduce((e,t,a)=>(e["#"+a]=t,e),{})},o=await e.get(n).promise();return o.Item&&o.Item.prices})(e,a,t.filter(e=>xe(e)===a))))).reduce((e,t)=>({...e,...t}),{})})(e,a))[t]},ke=(e,t,a=2)=>new fe.a(e).plus(t).toFixed(null===a?void 0:a),Ie=(e,t)=>new fe.a(e).minus(new fe.a(t)).toFixed(2),Ee=(e,t,a=2)=>new fe.a(e).times(new fe.a(t)).toFixed(null===a?void 0:a),Pe=(e,t,a=fe.a.DP,n=fe.a.RM)=>new fe.a(e).div(new fe.a(t)).round(a,n).toFixed(a),Te=(e,t)=>new fe.a(e).cmp(new fe.a(t))>=0?e:t,Se=e=>e.map(e=>new fe.a(e)).reduce((e,t)=>e.plus(t),new fe.a(0)).toFixed(2),De=(e,t)=>Ee(e,Pe(t,100,fe.a.DP)),Ae=(e,t,a,n=2)=>Ee(e,Pe(t,a,fe.a.DP),n),_e=e=>e.reduce((e,t)=>{return void 0===e?t:(a=e,n=t,new fe.a(a).cmp(new fe.a(n))<0?a:n);var a,n},void 0),Ne=e=>e.reduce((e,t)=>void 0===e?t:Te(e,t),void 0);var Be=({defaultCurrency:e,currencies:t})=>{const{documentDB:a}=o.a.useContext(N),[n,r]=o.a.useState(void 0);o.a.useEffect(()=>{if(a&&e&&t&&t.length){const n=t.filter(t=>t!==e).map(t=>`${t}/${e}`);Promise.all(n.map(e=>we(a,e))).then(e=>{const a=e.reduce((e,a,n)=>(e[t[n]]=a,e),{});r(a)}).catch(e=>{r(void 0),console.error("Could not get currency exchange rates",e)})}else r(void 0)},[a,e,t]);return{toDefaultCurrency:o.a.useMemo(()=>{if(n&&e&&t&&(t.includes(e)||Object.keys(n).length))return(t,a)=>a===e?t:Ee(t,n[a])},[n,e,t]),backToAssetCurrency:o.a.useMemo(()=>{if(n&&e&&t&&(t.includes(e)||Object.keys(n).length))return(t,a)=>a===e?t:Ee(t,Pe("1",n[a]))},[n,e,t])}};const Oe=(e,t)=>parseFloat(e).toLocaleString("pt-BR",{maximumFractionDigits:20,minimumFractionDigits:t&&t}),Me={"fixed-income":"Renda Fixa",reit:"Imobiliário","stock-picking":"Ações","stocks-fund":"Fundo de Ações",multistrategy:"Multimercado","bdr-stock":"BDR de Stock","bdr-reit":"BDR de REIT"},Ve={buy:"Compra",sell:"Venda"},Fe=["BRL","USD","EUR"],ze=o.a.createElement,{Box:Re,Button:je,Chip:Le,Divider:$e,Icon:We,FormControl:Ue,Grid:qe,InputLabel:Qe,MenuItem:Ge,Paper:Ke,Select:He,Table:Je,TableBody:Xe,TableCell:Ye,TableContainer:Ze,TableHead:et,TableRow:tt,TextField:at,Typography:nt}=i,ot=({setAvailableValue:e,setDefaultCurrency:t})=>{const[a,n]=o.a.useState(!0);return ze("form",{onSubmit:a=>{a.preventDefault(),e(a.target.availableValue.value),t(a.target.currency.value)}},ze(qe,{container:!0,alignItems:"center",spacing:2},ze(qe,{item:!0,xs:12},ze(nt,{variant:"body1"},"Informe o valor disponível para calcular a alocação proporcional")),ze(qe,{item:!0},ze(Ue,{fullWidth:!0},ze(Qe,{id:"currency-label"},"Moeda"),ze(He,{name:"currency",defaultValue:"BRL",labelId:"currency-label",required:!0,variant:"filled"},Fe.map(e=>ze(Ge,{key:e,value:e},e))))),ze(qe,{item:!0},ze(at,{name:"availableValue",type:"number",label:"Valor disponível",variant:"filled",onChange:e=>{try{fe()(e.target.value),n(!0)}catch(e){n(!1)}},error:!a,inputProps:{min:0,step:"0.01",style:{textAlign:"right"}}},null)),ze(qe,{item:!0},ze(je,{type:"submit",variant:"contained",color:"primary",disabled:!a},"Calcular aportes"))))};var rt=()=>{const{user:{identityId:e}}=o.a.useContext(S),{documentDB:t}=o.a.useContext(N),[a,n]=o.a.useState(void 0),[r,l]=o.a.useState(void 0),[i,s]=o.a.useState(void 0),[c,u]=o.a.useState(void 0),[d,p]=o.a.useState(void 0),{toDefaultCurrency:m,backToAssetCurrency:g}=Be({defaultCurrency:c,currencies:d});o.a.useEffect(()=>{t&&e?be(t,e).then(e=>{n({assets:e})}).catch(()=>{n(void 0)}):n(void 0)},[t,e]),o.a.useEffect(()=>{if(a&&a.assets&&a.assets.length&&c&&r&&m&&g){const e=((e,t,a,n)=>{const o=Se(e.assets.map(e=>a(e.value,e.currency))),r=ke(o,t),l=[...e.assets];let i=l.reduce((e,t)=>{const a=`${t.currency}|${t.category}`;return e[a]||(e[a]={targetPercent:"0.0000",value:"0.00"}),e[a].targetPercent=ke(e[a].targetPercent,t.targetPercent),e[a].value=ke(e[a].value,t.value),e},{});i=Object.entries(i).reduce((e,[t,a])=>{const[o]=t.split("|");return a.idealFutureValue=n(De(r,a.targetPercent),o),a.idealInvestment=Te("0.00",Ie(a.idealFutureValue,a.value)),e},i);const s=Se(Object.entries(i).map(([e,t])=>{const[n]=e.split("|");return a(t.idealInvestment,n)}));i=Object.entries(i).reduce((e,[o,r])=>{const[l]=o.split("|");return r.proportionalizedIdealInvestment="0.00"===s?"0.00":n(Ae(a(r.idealInvestment,l),t,s),l),e},i),l.forEach(e=>{const t=`${e.currency}|${e.category}`,a=i[t],o=ke(a.value,a.proportionalizedIdealInvestment);e.idealFutureValue="0.00"===a.targetPercent?"0.00":n(De(o,Pe(Ee("100.00",e.targetPercent),a.targetPercent)),e.currency),e.idealInvestment=Te("0.00",Ie(e.idealFutureValue,e.value))}),i=l.reduce((e,t)=>{const a=`${t.currency}|${t.category}`,n=i[a];return n.totalAssetIdealInvestment||(n.totalAssetIdealInvestment="0.00"),n.totalAssetIdealInvestment=ke(n.totalAssetIdealInvestment,t.idealInvestment),e},i),l.forEach(e=>{const t=`${e.currency}|${e.category}`,o=i[t];e.proportionalizedIdealInvestment="0.00"===o.totalAssetIdealInvestment?"0.00":n(Ae(o.proportionalizedIdealInvestment,a(e.idealInvestment,e.currency),o.totalAssetIdealInvestment),e.currency)}),l.forEach(e=>{e.investmentQuantity=Ee(e.minimum,Pe(e.proportionalizedIdealInvestment,Ee(e.price,e.minimum,fe.a.DP),0,0),null)}),l.forEach(e=>{e.investment=Ee(e.investmentQuantity,e.price)});const c=Se(l.map(e=>a(e.investment,e.currency))),u=Ie(t,c);l.forEach(e=>{e.futureQuantity=ke(e.quantity,e.investmentQuantity,null)}),l.forEach(e=>{e.futureValue=Ee(e.futureQuantity,e.price)});const d=Se(l.map(e=>a(e.futureValue,e.currency)));return l.forEach(e=>{e.futurePercent="0.00"===d?"0.0000":Ee("100.00",Pe(a(e.futureValue,e.currency),d),4)}),{assets:l,totalInvestment:c,remainingAvailableValue:u}})(a,r,m,g);s(e)}else s(void 0)},[a,c,r,m,g]),o.a.useEffect(()=>{p(a?[...new Set(Object.values(a.assets).map(({currency:e})=>e))]:void 0)},[a]);const y=i&&i.assets||a&&a.assets;return ze(o.a.Fragment,null,ze(ot,{setDefaultCurrency:u,setAvailableValue:l},null),ze($e,{absolute:!1,style:{marginTop:"0.5em",marginBottom:"0.5em"}},null),y&&ze(Ze,{component:Re,style:{width:"fit-content"}},ze(Je,{style:{tableLayout:"auto",borderCollapse:"separate",borderSpacing:"10px"}},ze(et,null,ze(tt,null,ze(Ye,{style:{border:0}}),ze(Ye,{style:{border:0}}),ze(Ye,{align:"center",style:{border:0}},"Posição atual"),i&&ze(Ye,{style:{border:0}}),i&&ze(Ye,{align:"center",style:{border:0}},"Novo aporte"),i&&ze(Ye,{style:{border:0}}),i&&ze(Ye,{align:"center",style:{border:0}},"Posição futura"))),ze(Xe,null,y.map(e=>ze(tt,{key:e.code},ze(Ye,{style:{display:"contents"}},ze(Re,{component:Ke,p:2,style:{display:"table-cell",verticalAlign:"middle"}},ze(qe,{container:!0},ze(qe,{item:!0,xs:6},ze(nt,null,e.code)),ze(qe,{item:!0,xs:6,align:"right"},ze(nt,{variant:"caption",color:"textSecondary"},e.currency+" "),ze(nt,{display:"inline"},""+Oe(e.price))),ze(qe,{item:!0,xs:12},ze(Le,{size:"small",label:e.name}))))),ze(Ye,{style:{display:"contents"}},ze(Re,{component:Ke,p:2,align:"center",style:{display:"table-cell",verticalAlign:"middle"}},ze(nt,{variant:"caption",color:"textSecondary"},"objetivo"),ze(nt,null,Oe(e.targetPercent)+"%"))),ze(Ye,{style:{display:"contents"}},ze(Re,{component:Ke,p:2,align:"center",style:{display:"table-cell",verticalAlign:"middle"}},ze(nt,{variant:"caption",display:"block"},Oe(e.quantity)+" cotas"),ze(nt,{variant:"caption",color:"textSecondary"},e.currency+" "),ze(nt,{display:"inline"},""+Oe(e.value,2)),ze(nt,{variant:"body2"},Oe(e.currentPercent)+"%"))),i&&ze(Ye,{padding:"none",align:"center",style:{border:0}},ze(We,null,"chevron_right")),i&&ze(Ye,{style:{display:"contents"}},ze(Re,{component:Ke,p:2,align:"center",elevation:"0"===e.investmentQuantity?1:6,style:{display:"table-cell",verticalAlign:"middle",..."0"!==e.investmentQuantity&&{backgroundColor:"lightblue"}}},ze(nt,{variant:"caption"},e.code),ze(nt,{style:{..."0"!==e.investmentQuantity&&{fontWeight:"bold"}}},Oe(e.investmentQuantity)+" cotas"),ze(nt,{variant:"caption",color:"textSecondary"},e.currency+" "),ze(nt,{variant:"caption"},""+Oe(e.investment,2)))),i&&ze(Ye,{padding:"none",align:"center",style:{border:0}},ze(We,null,"chevron_right")),i&&ze(Ye,{style:{display:"contents"}},ze(Re,{component:Ke,p:2,align:"center",style:{display:"table-cell",verticalAlign:"middle"}},ze(nt,{variant:"caption",display:"block"},Oe(e.futureQuantity)+" cotas"),ze(nt,{variant:"caption",color:"textSecondary"},e.currency+" "),ze(nt,{display:"inline"},""+Oe(e.futureValue,2)),ze(nt,{variant:"body2"},Oe(e.futurePercent)+"%"))))),ze(tt,null,ze(Ye,{style:{border:0}}),ze(Ye,{style:{border:0}}),ze(Ye,{style:{border:0}}),i&&ze(Ye,{style:{border:0}}),i&&ze(Ye,{align:"center",padding:"none",style:{border:0}},ze(Re,{component:Ke,p:2,elevation:6,align:"center"},ze(nt,{variant:"caption",color:"textSecondary",display:"block"},"aporte efetivo"),ze(nt,{variant:"caption",color:"textSecondary"},c+" "),ze(nt,{display:"inline"},""+Oe(i.totalInvestment,2)),ze($e,{light:!0,variant:"fullWidth"},null),ze(nt,{variant:"caption",color:"textSecondary",display:"block"},"valor restante"),ze(nt,{variant:"caption",color:"textSecondary"},c+" "),ze(nt,{display:"inline"},""+Oe(i.remainingAvailableValue,2)))),i&&ze(Ye,{style:{border:0}}),i&&ze(Ye,{style:{border:0}}))))))};const lt=o.a.createElement,{Box:it,Button:st,Container:ct,Dialog:ut,DialogActions:dt,DialogContent:pt,DialogTitle:mt,Grid:gt,Paper:yt,TextField:vt,Typography:ht}=i,ft=e=>{return t=e.map(e=>e.weight),Pe(Se(t),t.length);var t},bt=e=>Se(e.map(e=>e.weight)),Ct=e=>0===e.length?"0":Te("0",Ie(ft(e),Ee((10/e.length).toFixed(2),(e=>_e(e.map(e=>e.weight)))(e)))),xt=e=>e.reduce((e,t)=>e.includes(t.currency)?e:[...e,t.currency],[]),wt=({allocations:e,updatedAllocations:t,dismissAllocationEdition:a})=>{const{showMessage:n}=o.a.useContext(h),{user:{identityId:r}}=o.a.useContext(S),{documentDB:l}=o.a.useContext(N),{updatePortofolio:i}=ie(),s=()=>{a()};return lt(ut,{open:!0,onClose:s,fullWidth:!0,maxWidth:"md"},lt("form",{onSubmit:o=>{o.preventDefault();const s=e.map(({currency:e,category:t})=>({currency:e,category:t,weight:o.target[`weight-${e}-${t}`].value}));((e,t,a)=>{const n={TableName:"target_allocation",Key:{user_id:t},UpdateExpression:"set allocations = :allocations",ExpressionAttributeValues:{":allocations":a}};return e.update(n).promise()})(l,r,s).then(()=>{n("Pesos atualizados com sucesso"),t(s),a(),i()}).catch(e=>{n("Não foi possível alterar os pesos"),console.error("Could not update allocations",e)})}},lt(mt,null,"Alterar Pesos"),lt(pt,null,xt(e).map(t=>{const a=e.filter(e=>e.currency===t);return lt(it,{key:t,margin:2,style:{display:"flex",alignItems:"center"}},lt(ht,{variant:"subtitle1"},t),a.map(e=>lt(it,{key:e.category,padding:1,width:e.widthPercent+"%"},lt(vt,{name:`weight-${t}-${e.category}`,type:"number",defaultValue:e.weight,label:Me[e.category],variant:"outlined",fullWidth:!0,inputProps:{min:0,step:"0.01",style:{textAlign:"center"}}},null))))})),lt(dt,null,lt(st,{onClick:s,variant:"contained",color:"secondary"},"Cancelar"),lt(st,{type:"submit",variant:"contained",color:"primary"},"Salvar"))))};var kt=()=>{const{user:{identityId:e}}=o.a.useContext(S),{documentDB:t}=o.a.useContext(N),[a,n]=o.a.useState([]),[r,l]=o.a.useState([]),[i,s]=o.a.useState([]),[c,u]=o.a.useState(!1);o.a.useEffect(()=>{t&&e?((async(e,t)=>{const a={TableName:"target_allocation",Key:{user_id:t},AttributesToGet:["allocations"]},n=await e.get(a).promise();return n.Item&&n.Item.allocations||[]})(t,e).then(e=>{n(e)}).catch(()=>{n([])}),be(t,e).then(e=>{l(e)}).catch(()=>{l([])})):(n([]),l([]))},[t,e]),o.a.useEffect(()=>{s(a&&r?((e,t)=>{let a=e.map(e=>({...e,currentPercent:Se(t.filter(t=>t.category===e.category&&t.currency===e.currency).map(e=>e.currentPercent))}));const n=bt(a);a=a.map(e=>({...e,targetPercent:"0.00"===n?"0.00":Pe(Ee("100",e.weight),n,2)}));const o=xt(e),r=o.map(t=>Ct(e.filter(e=>e.currency===t))),l=Ne(r),i=Ne(o.map(t=>{const a=e.filter(e=>e.currency===t);return ke(bt(a),Ee(l,a.length.toFixed(2)))}));return a=a.map(e=>{const t=Pe(Ee(o.length.toFixed(2),"100"),a.length.toFixed(2),2),n=ke(e.weight,l),r=Te("10.00","0.00"===i?t:Pe(Ee(n,"100"),i,2));return{...e,widthPercent:r}}),a})(a,r):[])},[a,r]);const d=o.a.useCallback(()=>{u(!1)},[]),p=o.a.useCallback(e=>{n(e)},[]);return i&&0!==i.length?lt(o.a.Fragment,null,lt(ct,{maxWidth:!1},lt(it,{align:"center",margin:1},lt(st,{onClick:()=>{u(!0)},variant:"contained"},"Alterar pesos")),xt(i).map(e=>{const t=i.filter(t=>t.currency===e);return lt(it,{key:e,margin:2,style:{display:"flex",alignItems:"center"}},lt(ht,{variant:"h6"},e),t.map(e=>lt(it,{component:yt,key:e.category,padding:1,margin:1,width:e.widthPercent+"%",align:"center"},lt(ht,null,Me[e.category]),lt(ht,{variant:"subtitle1"},Oe(e.weight)),lt(gt,{container:!0,justify:"space-evenly"},lt(gt,{item:!0},lt(ht,{variant:"caption"},Oe(e.currentPercent)+"%"),lt(ht,{variant:"caption",display:"block",color:"textSecondary"},"atual")),lt(gt,{item:!0},lt(ht,{variant:"caption"},Oe(e.targetPercent)+"%"),lt(ht,{variant:"caption",display:"block",color:"textSecondary"},"objetivo"))))))})),c&&lt(wt,{allocations:i,updatedAllocations:p,dismissAllocationEdition:d},null)):null};const It=o.a.createElement,{Box:Et,Button:Pt,Dialog:Tt,DialogActions:St,DialogContent:Dt,DialogTitle:At,DialogContentText:_t,FormControl:Nt,InputLabel:Bt,Grid:Ot,MenuItem:Mt,Paper:Vt,Select:Ft,Table:zt,TableBody:Rt,TableCell:jt,TableContainer:Lt,TableHead:$t,TableRow:Wt,TextField:Ut}=i,qt=({selectedAsset:e,allAssetCodes:t,assetChanged:a,dismissAssetEdition:n})=>{const{showMessage:r}=o.a.useContext(h),{user:{identityId:l}}=o.a.useContext(S),{documentDB:i}=o.a.useContext(N),[s,c]=o.a.useState(!1),{updateTargetAllocation:u,updatePosition:d}=ie(),p=null===e.code,m=()=>{n()};return e?It(Tt,{open:!0,onClose:m},It("form",{onSubmit:t=>{t.preventDefault();const o={currency:t.target.currency.value,category:t.target.category.value,name:t.target.name.value,minimum:t.target.minimum.value,weight:t.target.weight.value},s=p?t.target.code.value:e.code;(async(e,t,a,n)=>{const o={TableName:"asset",Key:{user_id:t},UpdateExpression:"set assets.#assetCode = :asset",ExpressionAttributeNames:{"#assetCode":a},ExpressionAttributeValues:{":asset":n}};try{return await e.update(o).promise()}catch(o){if(o.message&&"The document path provided in the update expression is invalid for update"===o.message){const o={TableName:"asset",Key:{user_id:t},UpdateExpression:"set assets = :assets",ExpressionAttributeValues:{":assets":{[a]:n}}};return e.update(o).promise()}throw o}})(i,l,s,o).then(()=>{r(`Ativo ${p?"adicionado":"atualizado"} com sucesso`),a({code:s,...o},p?"DB_INSERT":"DB_UPDATE"),n(),u(),d()}).catch(e=>{r(`Não foi possível ${p?"adicionar":"atualizar"} o ativo`),console.error(`Could not ${p?"add":"update"} asset`,e)})}},It(At,null,""+(p?"Adicionar ativo":"Editar ativo: "+e.code)),It(Dt,null,It(Ot,{container:!0,spacing:2},p&&It(Ot,{item:!0,xs:6},It(Ut,{name:"code",defaultValue:"",label:"Código",required:!0,variant:"filled",fullWidth:!0,onChange:e=>{e.target.setCustomValidity(t.includes(e.target.value)?"Código já existente":""),e.target.reportValidity()}},null)),It(Ot,{item:!0,xs:2},It(Nt,{fullWidth:!0},It(Bt,{id:"currency-label"},"Moeda"),It(Ft,{name:"currency",defaultValue:e.currency,labelId:"currency-label",required:!0,variant:"filled"},Fe.map(e=>It(Mt,{key:e,value:e},e))))),It(Ot,{item:!0,xs:4},It(Nt,{fullWidth:!0},It(Bt,{id:"category-label"},"Categoria"),It(Ft,{name:"category",defaultValue:e.category||"",labelId:"category-label",required:!0,variant:"filled"},Object.entries(Me).map(([e,t])=>It(Mt,{key:e,value:e},t))))),It(Ot,{item:!0,xs:6},It(Ut,{name:"name",defaultValue:e.name,label:"Nome",required:!0,variant:"filled",fullWidth:!0},null)),It(Ot,{item:!0,xs:4},It(Ut,{name:"minimum",type:"number",defaultValue:e.minimum,label:"Qtd mínima",required:!0,variant:"filled",fullWidth:!0,inputProps:{min:0,step:"0.00000000000001",style:{textAlign:"right"}}},null)),It(Ot,{item:!0,xs:2},It(Ut,{name:"weight",type:"number",defaultValue:e.weight,label:"Peso",required:!0,variant:"filled",fullWidth:!0,inputProps:{min:0,step:"0.01",style:{textAlign:"right"}}},null)))),It(St,null,It(Et,{style:{flex:"auto"}},!p&&It(Pt,{onClick:()=>c(!0),variant:"outlined",color:"secondary"},"Excluir"),s&&It(Tt,{open:!0,onClose:()=>c(!1)},It(Dt,null,It(_t,null,`Confirma exclusão do ativo ${e.code}?`)),It(St,null,It(Pt,{onClick:()=>c(!1)},"Não"),It(Pt,{onClick:()=>{((e,t,a)=>{const n={TableName:"asset",Key:{user_id:t},UpdateExpression:"REMOVE assets.#assetCode",ExpressionAttributeNames:{"#assetCode":a}};return e.update(n).promise()})(i,l,e.code).then(()=>{r("Ativo excluído com sucesso"),a(e,"DB_DELETE"),n(),u(),d()}).catch(e=>{r("Não foi possível excluir o ativo"),console.error("Could not delete asset",e)})},autoFocus:!0},"Sim")))),It(Pt,{onClick:m,variant:"contained",color:"secondary"},"Cancelar"),It(Pt,{type:"submit",variant:"contained",color:"primary"},"Salvar")))):null},Qt=e=>e.sort((e,t)=>e.code.localeCompare(t.code)).sort((e,t)=>e.category.localeCompare(t.category)).sort((e,t)=>e.currency.localeCompare(t.currency));var Gt=()=>{const{user:{identityId:e}}=o.a.useContext(S),{documentDB:t}=o.a.useContext(N),[a,n]=o.a.useState([]),[r,l]=o.a.useState(),s=i.useTheme();o.a.useEffect(()=>{t&&e?Ce(t,e).then(e=>{n(Qt(Object.entries(e).map(([e,t])=>({code:e,...t}))))}).catch(()=>{n([])}):n([])},[t,e]);const c=o.a.useCallback(()=>{l(void 0)},[]),u=o.a.useCallback((e,t)=>{"DB_INSERT"===t?n(t=>Qt([...t,e])):"DB_UPDATE"===t?n(t=>Qt(t.map(t=>t.code===e.code?e:t))):"DB_DELETE"===t&&n(t=>t.filter(t=>t.code!==e.code))},[]);return It(o.a.Fragment,null,It(Et,{margin:1},It(Pt,{onClick:()=>{l({code:null})},variant:"contained"},"Novo ativo")),a&&0!==a.length?It(Lt,{component:Vt,style:{width:"fit-content"}},It(zt,{style:{tableLayout:"auto"}},It($t,{style:{backgroundColor:s.palette.background.default}},It(Wt,null,It(jt,null,"Moeda"),It(jt,null,"Categoria"),It(jt,null,"Código"),It(jt,null,"Nome"),It(jt,{align:"right"},"Qtd mínima"),It(jt,{align:"right"},"Peso"))),It(Rt,null,a.map(e=>It(Wt,{key:e.code,hover:!0,onClick:()=>(e=>{l(e)})(e)},It(jt,null,e.currency),It(jt,null,Me[e.category]),It(jt,null,e.code),It(jt,null,e.name),It(jt,{align:"right"},Oe(e.minimum)),It(jt,{align:"right"},Oe(e.weight))))))):null,r&&It(qt,{selectedAsset:r,allAssetCodes:a.map(({code:e})=>e),assetChanged:u,dismissAssetEdition:c},null))},Kt=a(5),Ht=a.n(Kt);const Jt=o.a.createElement,{Box:Xt,Button:Yt,Dialog:Zt,DialogActions:ea,DialogContent:ta,DialogTitle:aa,DialogContentText:na,FormControl:oa,InputLabel:ra,Grid:la,MenuItem:ia,Paper:sa,Select:ca,Table:ua,TableBody:da,TableCell:pa,TableContainer:ma,TableHead:ga,TableRow:ya,TextField:va}=i,ha=e=>e.sort((e,t)=>t.type.localeCompare(e.type)).sort((e,t)=>t.code.localeCompare(e.code)).sort((e,t)=>t.date.localeCompare(e.date)),fa=({selectedOperation:e,operationChanged:t,dismissOperationEdition:a,assets:n})=>{const{showMessage:r}=o.a.useContext(h),{user:{identityId:l}}=o.a.useContext(S),{documentDB:i}=o.a.useContext(N),[s,c]=o.a.useState(!1),[u,d]=o.a.useState(),[p,m]=o.a.useState(),{updatePosition:g}=ie(),y=null===e.operationId,v=o.a.useCallback(e=>{const t=Object.keys(n).includes(e)?n[e].minimum:"1";d(t),m(parseFloat(t)<1?t:"0.01")},[n]);o.a.useEffect(()=>{v(e.code)},[e.code,v]);const f=()=>{a()};return Jt(Zt,{open:!0,onClose:f},Jt("form",{onSubmit:n=>{n.preventDefault();const o={type:n.target.type.value,code:n.target.code.value,date:n.target.date.value,amount:n.target.amount.value,price:n.target.price.value,expenses:n.target.expenses.value},s=y?Ht()():e.operationId;(async(e,t,a,n)=>{const o={TableName:"operation",Key:{user_id:t},UpdateExpression:"set operations.#operationId = :operation",ExpressionAttributeNames:{"#operationId":a},ExpressionAttributeValues:{":operation":n}};try{return await e.update(o).promise()}catch(o){if(o.message&&"The document path provided in the update expression is invalid for update"===o.message){const o={TableName:"operation",Key:{user_id:t},UpdateExpression:"set operations = :operations",ExpressionAttributeValues:{":operations":{[a]:n}}};return e.update(o).promise()}throw o}})(i,l,s,o).then(()=>{r(`Operação ${y?"adicionada":"atualizada"} com sucesso`),t({operationId:s,...o},y?"DB_INSERT":"DB_UPDATE"),a(),g()}).catch(e=>{r(`Não foi possível ${y?"adicionar":"atualizar"} a operação`),console.error(`Could not ${y?"add":"update"} operation`,e)})}},Jt(aa,null,(y?"Adicionar":"Editar")+" operação"),Jt(ta,null,Jt(la,{container:!0,spacing:2},Jt(la,{item:!0,xs:3},Jt(oa,{fullWidth:!0},Jt(ra,{id:"type-label"},"Tipo"),Jt(ca,{name:"type",defaultValue:e.type||"",labelId:"type-label",required:!0,variant:"filled"},Object.entries(Ve).map(([e,t])=>Jt(ia,{key:e,value:e},t))))),Jt(la,{item:!0,xs:5},Jt(va,{name:"code",defaultValue:e.code,label:"Código",required:!0,variant:"filled",fullWidth:!0,onChange:e=>{e.target.setCustomValidity(Object.keys(n).includes(e.target.value)?"":"Código inexistente"),v(e.target.value)}},null)),Jt(la,{item:!0,xs:4},Jt(va,{name:"date",type:"date",defaultValue:e.date,label:"Data",InputLabelProps:{shrink:!0},required:!0,variant:"filled",fullWidth:!0},null)),Jt(la,{item:!0,xs:12},Jt(va,{name:"amount",type:"number",defaultValue:e.amount,label:"Quantidade",required:!0,variant:"filled",fullWidth:!0,inputProps:{min:0,step:u,style:{textAlign:"right"}}},null)),Jt(la,{item:!0,xs:12},Jt(va,{name:"price",type:"number",defaultValue:e.price,label:"Preço",required:!0,variant:"filled",fullWidth:!0,inputProps:{min:0,step:p,style:{textAlign:"right"}}},null)),Jt(la,{item:!0,xs:12},Jt(va,{name:"expenses",type:"number",defaultValue:e.expenses,label:"Despesas",required:!0,variant:"filled",fullWidth:!0,inputProps:{min:0,step:p,style:{textAlign:"right"}}},null)))),Jt(ea,null,Jt(Xt,{style:{flex:"auto"}},!y&&Jt(Yt,{onClick:()=>c(!0),variant:"outlined",color:"secondary"},"Excluir"),s&&Jt(Zt,{open:!0,onClose:()=>c(!1)},Jt(ta,null,Jt(na,null,"Confirma exclusão da operação?")),Jt(ea,null,Jt(Yt,{onClick:()=>c(!1)},"Não"),Jt(Yt,{onClick:()=>{((e,t,a)=>{const n={TableName:"operation",Key:{user_id:t},UpdateExpression:"REMOVE operations.#operationId",ExpressionAttributeNames:{"#operationId":a}};return e.update(n).promise()})(i,l,e.operationId).then(()=>{r("Operação excluída com sucesso"),t(e,"DB_DELETE"),a(),g()}).catch(e=>{r("Não foi possível excluir a operação"),console.error("Could not delete operation",e)})},autoFocus:!0},"Sim")))),Jt(Yt,{onClick:f,variant:"contained",color:"secondary"},"Cancelar"),Jt(Yt,{type:"submit",variant:"contained",color:"primary"},"Salvar"))))};var ba=()=>{const{user:{identityId:e}}=o.a.useContext(S),{documentDB:t}=o.a.useContext(N),[a,n]=o.a.useState([]),[r,l]=o.a.useState([]),[i,s]=o.a.useState(30),[c,u]=o.a.useState();o.a.useEffect(()=>{t&&e?((async(e,t)=>{const a={TableName:"operation",Key:{user_id:t},AttributesToGet:["operations"]},n=await e.get(a).promise();return n.Item&&n.Item.operations||{}})(t,e).then(e=>{l(ha(Object.entries(e).map(([e,t])=>({operationId:e,...t}))))}).catch(e=>{console.error("Could not retrieve operations",e),l([])}),Ce(t,e).then(e=>{n(e)}).catch(e=>{console.error("Could not retrieve assets",e),n([])})):(l([]),n([]))},[t,e]);const d=o.a.useCallback(()=>{u(void 0)},[]),p=o.a.useCallback((e,t)=>{"DB_INSERT"===t?l(t=>ha([...t,e])):"DB_UPDATE"===t?l(t=>ha(t.map(t=>t.operationId===e.operationId?e:t))):"DB_DELETE"===t&&l(t=>t.filter(t=>t.operationId!==e.operationId))},[]);return Jt(o.a.Fragment,null,Jt(Xt,{margin:1},Jt(Yt,{onClick:()=>{u({operationId:null})},variant:"contained"},"Nova operação")),r&&r.length>0&&Jt(ma,{component:sa,style:{width:"fit-content",maxHeight:"600px"},onScroll:e=>{e.target.scrollTop+e.target.clientHeight===e.target.scrollHeight&&s(e=>Math.min(r.length,e+30))}},Jt(ua,{stickyHeader:!0,style:{tableLayout:"auto"}},Jt(ga,null,Jt(ya,null,Jt(pa,null,"Tipo"),Jt(pa,null,"Código"),Jt(pa,null,"Data"),Jt(pa,{align:"right"},"Quantidade"),Jt(pa,{align:"right"},"Preço"),Jt(pa,{align:"right"},"Despesas"))),Jt(da,null,r.slice(0,i).map(e=>{return Jt(ya,{key:e.operationId,hover:!0,onClick:()=>(e=>{u(e)})(e)},Jt(pa,null,Ve[e.type]),Jt(pa,null,e.code),Jt(pa,null,(t=e.date,new Date(t).toLocaleDateString())),Jt(pa,{align:"right"},Oe(e.amount)),Jt(pa,{align:"right"},Oe(e.price)),Jt(pa,{align:"right"},Oe(e.expenses)));var t})))),i>30&&i<r.length&&Jt(Xt,{margin:1},Jt(Yt,{onClick:()=>{s(r.length)}},"Exibir todas")),c&&Jt(fa,{selectedOperation:c,operationChanged:p,dismissOperationEdition:d,assets:a},null))};const Ca=o.a.createElement,{Button:xa,Grid:wa}=i;var ka=()=>{const{updatePosition:e,updatePortofolio:t}=ie();return Ca(wa,{container:!0,spacing:1},Ca(wa,{item:!0},Ca(xa,{variant:"contained",onClick:()=>{e()},disabled:!e},"Atualizar Posição")),Ca(wa,{item:!0},Ca(xa,{variant:"contained",onClick:()=>{t()},disabled:!t},"Atualizar Portfólio")))};const Ia=o.a.createElement,{Button:Ea}=i;var Pa=[{name:"main",label:"Main",path:"/",hideFromMenu:!0,component:ue,options:{exact:!0}},{name:"target-allocation",label:"Macro-Alocação",path:"/target-allocation",component:kt},{name:"assets",label:"Meus Ativos",path:"/assets",component:Gt},{name:"suggestedAllocation",label:"Novo Aporte",path:"/suggested-allocation",component:rt},{name:"operations",label:"Registro de Operações",path:"/operations",component:ba},{name:"update-allocation",label:"Atualização do Portfólio",path:"/update-allocation",authorizedGroups:["admin"],component:ka},{name:"upload-prices",label:"Upload Prices",path:"/upload-prices",authorizedGroups:["admin"],component:()=>{const{showMessage:e}=o.a.useContext(h),{invokeLambda:t}=o.a.useContext(V),a=o.a.useRef(),{updatePortofolio:n}=ie(),r=a=>{const o=a.target.result;let r;try{r=o.split(/\r\n|\n/).slice(1).map(e=>[...e.matchAll(/"[^"]*"|[^,]+/g)]).reduce((e,t)=>{const[a,n]=t.map(e=>e[0]).map(e=>e.replace(/^"(.*)"$/,"$1")).map(e=>e.replace(",","."));return e[a]=n,e},{})}catch(t){e("Não foi possível carregar o arquivo"),console.error("File loading failed",t)}r&&t("update_prices",{prices:r}).then(()=>{e("Preços atualizados com sucesso"),n()}).catch(t=>{e("Não foi possível atualizar os preços"),console.error("Prices update failed",t)})};return Ia("form",{ref:a},Ia("input",{id:"contained-button-file",accept:".csv",type:"file",style:{display:"none"},onChange:e=>{const t=new FileReader;t.onload=r,t.onloadend=()=>a.current.reset(),t.readAsText(e.target.files[0])},disabled:!t},null),Ia("label",{htmlFor:"contained-button-file"},Ia(Ea,{disabled:!t,variant:"contained",color:"primary",component:"span"},"Upload Preços Atualizados")))}},{name:"authentication",label:"Athentication",path:"/authentication/:authorization_code",hideFromMenu:!0,component:ve}];const Ta=o.a.createElement,{HashRouter:Sa,Route:Da,Switch:Aa}=window.ReactRouterDOM,{Toolbar:_a}=i,Na=({children:e})=>Ta(u,null,Ta(v,null,Ta(T,null,Ta(_,null,Ta(M,null,e)))));if("/my-investment-wallet/"===window.location.pathname){const e=new URLSearchParams(window.location.search);null!==e.get("auth-redirect")&&null!==e.get("code")&&window.history.replaceState({},"","/my-investment-wallet/#/authentication/"+e.get("code"))}l.a.render(Ta(()=>{const[e,t]=o.a.useState(!1);return Ta(Na,null,Ta(Sa,null,Ta(J,{setDrawerOpen:t,routes:Pa},null),Ta(le,{routes:Pa,drawerOpen:e,setDrawerOpen:t}),Ta(_a,null,null),Ta(Aa,null,Pa.map(e=>Ta(Da,{key:e.name+"-route",path:e.path,...e.options},Ta(e.component))))))},null,null),document.getElementById("app_container"))}]);