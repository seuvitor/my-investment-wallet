!function(e){var t={};function a(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=t,a.d=function(e,t,o){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(o,n,function(t){return e[t]}.bind(null,n));return o},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=6)}([function(e,t){e.exports=React},function(e,t){e.exports=MaterialUI},function(e,t){e.exports=Big},function(e,t){e.exports=AWS},function(e,t){e.exports=ReactDOM},function(e,t){e.exports=uuidv4},function(e,t,a){"use strict";a.r(t);var o=a(0),n=a.n(o),r=a(4),i=a.n(r),l=a(1);const s=n.a.createElement,{ThemeProvider:c}=l;var u=({children:e})=>{const[t]=n.a.useState(l.createMuiTheme({palette:{primary:{main:"#556cd6"}}}));return s(c,{theme:t},e)};const d=n.a.createElement,{Icon:p,IconButton:m,Snackbar:g}=l,y=n.a.createContext(),v=({children:e})=>{const[t,a]=n.a.useState([]),[o,r]=n.a.useState(void 0),[i,l]=n.a.useState(!1);n.a.useEffect(()=>{t.length&&!o?(r(t[0]),a(e=>e.slice(1)),l(!0)):t.length&&o&&i&&l(!1)},[t,o,i]);const s=n.a.useCallback(e=>{a(t=>[...t,e])},[]),c=(e,t)=>{"clickaway"!==t&&l(!1)};return d(y.Provider,{value:{showMessage:s}},e,d(g,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:i,autoHideDuration:5e3,onClose:c,onExited:()=>{r(void 0)},message:o,action:d(m,{color:"inherit",onClick:c},d(p,null,"close"))},null))};var h=y,f=a(3),b=a.n(f);const C="https://carteira-investimentos.auth.us-east-1.amazoncognito.com",x=C+"/oauth2/token",w="7s3vb9runcfjvgetrvhdfd97at",k="https://seuvitor.github.io/my-investment-wallet/?auth-redirect",I=`${C}/login?client_id=${w}&response_type=code&scope=email+openid+profile&redirect_uri=${k}`,E=n.a.createElement,P=n.a.createContext(),T=({children:e})=>{const[t,a]=n.a.useState({identityId:void 0,id:void 0,name:void 0,email:void 0,groups:void 0,idToken:void 0,accessToken:void 0}),[o,r]=n.a.useState(sessionStorage.getItem("my-investment-wallet-refresh-token")),[i,l]=n.a.useState(void 0),[s]=n.a.useState(15e5),[c,u]=n.a.useState(void 0);n.a.useEffect(()=>{o?sessionStorage.setItem("my-investment-wallet-refresh-token",o):sessionStorage.removeItem("my-investment-wallet-refresh-token")},[o]);const d=n.a.useCallback(()=>new Promise(e=>{a({identityId:void 0,id:void 0,name:void 0,email:void 0,groups:void 0,idToken:void 0,accessToken:void 0}),r(void 0),l(void 0),e()}),[]);n.a.useEffect(()=>{l(c?e=>e?(e.update({credentials:c}),e):new b.a.Config({region:"us-east-1",credentials:c}):void 0)},[c]);const p=n.a.useCallback((e,t)=>{const o=new b.a.CognitoIdentityCredentials({IdentityPoolId:"us-east-1:874c45d2-0eb6-4d04-92f0-b8769dcbcc54",...e&&{Logins:{"cognito-idp.us-east-1.amazonaws.com/us-east-1_SjfN8ExVX":e}}},{region:"us-east-1"});return new Promise((n,r)=>{o.clearCachedId(),o.getPromise().then(()=>{u(o),a(a=>{const n=e&&JSON.parse(atob(e.split(".")[1]));return a.identityId=o.identityId,a.id=n&&n.sub,a.name=n?n.name:"Usuário não logado",a.email=n&&n.email,a.groups=n&&n["cognito:groups"],a.idToken=e,a.accessToken=t,a}),n()}).catch(e=>{u(void 0),a({identityId:void 0,id:void 0,name:void 0,email:void 0,groups:void 0,idToken:void 0,accessToken:void 0}),console.warn("Could not validate credentials",e),r(e)})})},[]),m=n.a.useCallback(e=>new Promise((t,a)=>{e?fetch(x,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`grant_type=refresh_token&client_id=${w}&refresh_token=${e}`}).then(e=>{e.json().then(e=>{p(e.id_token,e.access_token).then(()=>{t()}).catch(e=>{console.error("Could not login with refreshed tokens",e),a(e)})}).catch(e=>{console.error("Could not decode authentication response",e),a(e)})}).catch(e=>{console.error("Could not get refreshed tokens",e),a(e)}):(console.warn("No refreshToken available"),a(new Error("No refreshToken available")))}),[p]);((e,t)=>{const a=n.a.useRef(),o=n.a.useCallback(()=>{const e=a.current;e&&(a.current=void 0,clearInterval(e))},[a]);n.a.useEffect(()=>(a.current=setInterval(e,t),o),[e,t,o])})(n.a.useCallback(()=>{m(o).catch(e=>{console.error("Could not refresh tokens",e)})},[o,m]),s);const g=n.a.useCallback(()=>p(),[p]),y=n.a.useCallback(e=>new Promise((t,a)=>{fetch(x,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`grant_type=authorization_code&client_id=${w}&code=${e}&redirect_uri=${k}`}).then(e=>{e.json().then(e=>{m(e.refresh_token).then(()=>{r(e.refresh_token),t()}).catch(e=>{console.error("Could not login with refreshed tokens",e),r(void 0),a(e)})}).catch(e=>{console.error("Could not decode authentication response",e),r(void 0),a(e)})}).catch(e=>{console.error("Could not get identification tokens with this authorization code",e),r(void 0),a(e)})}),[m]);return n.a.useEffect(()=>{o&&!c&&m(o).catch(e=>{console.error("Could not refresh tokens",e)})},[o,c,m]),E(P.Provider,{value:{user:t,awsConfig:i,awsCredentials:c,loginAnonymously:g,loginWithAuthorizationCode:y,logoff:d}},e)};var S=P;const D=n.a.createElement,A=n.a.createContext(),_=({children:e})=>{const{awsConfig:t,awsCredentials:a}=n.a.useContext(S),[o,r]=n.a.useState();return n.a.useEffect(()=>{r(t?new b.a.DynamoDB.DocumentClient(t):void 0)},[t]),n.a.useEffect(()=>{a&&r(e=>(e&&e.service.config.update({credentials:a}),e))},[a]),D(A.Provider,{value:{documentDB:o}},e)};var N=A;const O=n.a.createElement,B=n.a.createContext(),F=({children:e})=>{const{user:{accessToken:t},awsConfig:a,awsCredentials:o}=n.a.useContext(S),[r,i]=n.a.useState();n.a.useEffect(()=>{i(a?new b.a.Lambda(a):void 0)},[a]),n.a.useEffect(()=>{o&&i(e=>(e&&e.config.update({credentials:o}),e))},[o]);const l=n.a.useCallback((e,a)=>{const o={FunctionName:e,ClientContext:btoa(JSON.stringify({accessToken:t}))};return a&&(o.Payload=JSON.stringify(a)),new Promise((e,t)=>{r.invoke(o).promise().then(a=>{a.StatusCode&&200===a.StatusCode&&a.Payload||t(a);const o=JSON.parse(a.Payload);o&&o.statusCode&&200===o.statusCode||t(a),e(o.body)}).catch(e=>{t(e)})})},[r,t]);return O(B.Provider,{value:{invokeLambda:r&&l}},e)};var M=B;const V=n.a.createElement,{useLocation:z}=window.ReactRouterDOM,{AppBar:R,Button:j,Divider:L,Icon:$,IconButton:W,Menu:U,MenuItem:q,Toolbar:Q,Typography:G}=l,K=()=>{const{user:{name:e}}=n.a.useContext(S);return e?null:V(n.a.Fragment,null,V(j,{color:"inherit",href:I},"Login"))},H=()=>{const{showMessage:e}=n.a.useContext(h),{user:{name:t},logoff:a}=n.a.useContext(S),[o,r]=n.a.useState(!1),i=n.a.useRef(null);return t?V(n.a.Fragment,null,V(W,{color:"inherit",ref:i,onClick:()=>{r(!0)}},V($,null,"account_circle")),V(U,{open:o,onClose:()=>{r(!1)},anchorEl:i.current,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},V(q,{disabled:!0},t),V(L,null,null),V(q,{onClick:()=>{a().then(()=>{e("Usuário deslogado com sucesso")}).catch(t=>{e("Não foi possível deslogar o usuário"),console.error("Logoff failed",t)}),r(!1)}},"Logoff"))):null};var J=({setDrawerOpen:e,routes:t})=>{const a=z(),o=t.find(e=>e.path===a.pathname);return V(R,null,V(Q,null,V(W,{edge:"start",color:"inherit",onClick:()=>e(!0)},V($,null,"menu")),V(G,{style:{flexGrow:1}},o?o.label:""),V(K,null,null),V(H,null,null)))};const X=n.a.createElement,{NavLink:Y}=window.ReactRouterDOM,{Box:Z,Divider:ee,Drawer:te,Icon:ae,ListItem:oe,ListItemText:ne,Toolbar:re}=l;var ie=({routes:e,drawerOpen:t,setDrawerOpen:a})=>{const{user:{groups:o}}=n.a.useContext(S),r=()=>a(!1);return X(te,{open:t,onClose:r},X(re,{onClick:r,style:{padding:"inherit"}},X(oe,{button:!0,style:{justifyContent:"space-between",height:"100%"}},X(Z,{style:{flex:"auto",textAlign:"center"}},X("img",{src:"https://d3oia8etllorh5.cloudfront.net/us-east-1_SjfN8ExVX/ALL/20200706011733/assets/images/image.jpg",width:"70px",height:"70px"},null)),X(ae,null,"chevron_left"))),X(ee,null,null),e.filter(e=>!e.hideFromMenu).filter(e=>{return!(t=e.authorizedGroups)||!!o&&t.some(e=>o.includes(e));var t}).map(e=>X(oe,{key:e.name+"-route-drawer-item",button:!0,component:Y,activeClassName:"Mui-selected",to:e.path,onClick:r,...e.options},X(ne,{primary:e.label},null))))};var le=()=>{const{showMessage:e}=n.a.useContext(h),{user:{identityId:t}}=n.a.useContext(S),{invokeLambda:a}=n.a.useContext(M),o=n.a.useCallback(()=>new Promise((o,n)=>{a("update_asset_allocation",{user_id:t}).then(()=>{e("Portfólio atualizado com sucesso"),o()}).catch(t=>{e("Não foi possível atualizar o portfólio"),console.error("Portfolio update failed",t),n(t)})}),[e,t,a]),r=n.a.useCallback(()=>new Promise((n,r)=>{a("update_target_allocation",{user_id:t}).then(()=>{e("Macro-alocação atualizada com sucesso"),o().then(()=>{n()}).catch(e=>{r(e)})}).catch(t=>{e("Não foi possível atualizar a macro-alocação"),console.error("Target allocation update failed",t),r(t)})}),[e,t,a,o]),i=n.a.useCallback(()=>new Promise((n,r)=>{a("update_position",{user_id:t}).then(()=>{e("Posição atualizada com sucesso"),o().then(()=>{n()}).catch(e=>{r(e)})}).catch(t=>{e("Não foi possível atualizar a posição"),console.error("Position update failed",t),r(t)})}),[e,t,a,o]);return{updatePosition:a&&i,updateTargetAllocation:a&&r,updatePortofolio:a&&o}};const se=n.a.createElement,{Redirect:ce}=window.ReactRouterDOM;var ue=()=>{const{user:{identityId:e}}=n.a.useContext(S),{updatePortofolio:t}=le();return n.a.useEffect(()=>{t&&t()},[t]),e?se(ce,{to:"/target-allocation"},null):null};const de=n.a.createElement,{useParams:pe,useHistory:me}=window.ReactRouterDOM,{Backdrop:ge,CircularProgress:ye}=l;var ve=()=>{const{showMessage:e}=n.a.useContext(h),{loginWithAuthorizationCode:t}=n.a.useContext(S),{authorization_code:a}=pe(),[o,r]=n.a.useState(!0),i=l.useTheme(),s=me();return n.a.useEffect(()=>{t(a).then(()=>{e("Usuário logado com sucesso"),s.replace("/")}).catch(t=>{e("Não foi possível completar o login"),console.error("Login failed",t),r(!1)})},[a,t,e,s]),de(ge,{open:o,style:{zIndex:1+i.zIndex.drawer}},de(ye,null,null))},he=a(2),fe=a.n(he);const be=async(e,t)=>{const a={TableName:"priced_position",Key:{user_id:t},AttributesToGet:["assets"]},o=await e.get(a).promise();return o.Item&&o.Item.assets||{}},Ce=async(e,t)=>{const a={TableName:"asset",Key:{user_id:t},AttributesToGet:["assets"]},o=await e.get(a).promise();return o.Item&&o.Item.assets||{}},xe=e=>e.startsWith("0")?"0":e.startsWith("1")?"1":e.startsWith("2")?"2":e[0]>="3"&&e[0]<="9"?"3-9":"a-z",we=async(e,t)=>{const a=[t];return(await(async(e,t)=>{const a=t.map(e=>xe(e)),o=[...new Set(a)];return(await Promise.all(o.map(a=>(async(e,t,a)=>{const o={TableName:"price",Key:{partition:t},ProjectionExpression:a.map((e,t)=>"prices.#"+t).join(","),ExpressionAttributeNames:a.reduce((e,t,a)=>(e["#"+a]=t,e),{})},n=await e.get(o).promise();return n.Item&&n.Item.prices})(e,a,t.filter(e=>xe(e)===a))))).reduce((e,t)=>({...e,...t}),{})})(e,a))[t]},ke=(e,t,a=2)=>new fe.a(e).plus(t).toFixed(null===a?void 0:a),Ie=(e,t)=>new fe.a(e).minus(new fe.a(t)).toFixed(2),Ee=(e,t,a=2)=>new fe.a(e).times(new fe.a(t)).toFixed(null===a?void 0:a),Pe=(e,t,a=fe.a.DP,o=fe.a.RM)=>new fe.a(e).div(new fe.a(t)).round(a,o).toFixed(a),Te=(e,t)=>new fe.a(e).cmp(new fe.a(t))>=0?e:t,Se=e=>e.map(e=>new fe.a(e)).reduce((e,t)=>e.plus(t),new fe.a(0)).toFixed(2),De=(e,t)=>Ee(e,Pe(t,100,fe.a.DP)),Ae=(e,t)=>new fe.a(e).cmp(new fe.a(t))<0?e:t,_e=e=>e.reduce((e,t)=>void 0===e?t:Te(e,t),void 0);var Ne=({defaultCurrency:e,currencies:t})=>{const{documentDB:a}=n.a.useContext(N),[o,r]=n.a.useState(void 0);n.a.useEffect(()=>{if(a&&e&&t&&t.length){const o=t.filter(t=>t!==e).map(t=>`${t}/${e}`);Promise.all(o.map(e=>we(a,e))).then(e=>{const a=e.reduce((e,a,o)=>(e[t[o]]=a,e),{});r(a)}).catch(e=>{r(void 0),console.error("Could not get currency exchange rates",e)})}else r(void 0)},[a,e,t]);return{toDefaultCurrency:n.a.useMemo(()=>{if(o&&e&&t&&(t.includes(e)||Object.keys(o).length))return(t,a)=>a===e?t:Ee(t,o[a])},[o,e,t]),backToAssetCurrency:n.a.useMemo(()=>{if(o&&e&&t&&(t.includes(e)||Object.keys(o).length))return(t,a)=>a===e?t:Ee(t,Pe("1",o[a]))},[o,e,t])}};const Oe=(e,t)=>parseFloat(e).toLocaleString("pt-BR",{maximumFractionDigits:20,minimumFractionDigits:t&&t}),Be={"fixed-income":"Renda Fixa",reit:"Imobiliário","stock-picking":"Ações","stocks-fund":"Fundo de Ações",multistrategy:"Multimercado","bdr-stock":"BDR de Stock","bdr-reit":"BDR de REIT"},Fe={buy:"Compra",sell:"Venda"},Me=["BRL","USD","EUR"],Ve=n.a.createElement,{Box:ze,Button:Re,Chip:je,Divider:Le,Icon:$e,FormControl:We,Grid:Ue,InputLabel:qe,MenuItem:Qe,Paper:Ge,Select:Ke,Table:He,TableBody:Je,TableCell:Xe,TableContainer:Ye,TableHead:Ze,TableRow:et,TextField:tt,Typography:at}=l,ot=({setAvailableValue:e,setDefaultCurrency:t})=>{const[a,o]=n.a.useState(!0);return Ve("form",{onSubmit:a=>{a.preventDefault(),e(a.target.availableValue.value),t(a.target.currency.value)}},Ve(Ue,{container:!0,alignItems:"center",spacing:2},Ve(Ue,{item:!0,xs:12},Ve(at,{variant:"body1"},"Informe o valor disponível para calcular a alocação proporcional")),Ve(Ue,{item:!0},Ve(We,{fullWidth:!0},Ve(qe,{id:"currency-label"},"Moeda"),Ve(Ke,{name:"currency",defaultValue:"BRL",labelId:"currency-label",required:!0,variant:"filled"},Me.map(e=>Ve(Qe,{key:e,value:e},e))))),Ve(Ue,{item:!0},Ve(tt,{name:"availableValue",type:"number",label:"Valor disponível",variant:"filled",onChange:e=>{try{fe()(e.target.value),o(!0)}catch(e){o(!1)}},error:!a,inputProps:{min:0,step:"0.01",style:{textAlign:"right"}}},null)),Ve(Ue,{item:!0},Ve(Re,{type:"submit",variant:"contained",color:"primary",disabled:!a},"Calcular aportes"))))},nt=(e,t,a,o)=>{const n=Se(e.assets.map(e=>a(e.value,e.currency))),r=ke(n,t),i=[...e.assets];let l=i.reduce((e,t)=>{const a=`${t.currency}|${t.category}`;return e[a]||(e[a]={targetPercent:"0.0000",value:"0.00"}),e[a].targetPercent=ke(e[a].targetPercent,t.targetPercent),e[a].value=ke(e[a].value,t.value),e},{});l=Object.entries(l).reduce((e,[t,a])=>{const[n]=t.split("|");return a.idealFutureValue=o(De(r,a.targetPercent),n),a.idealInvestment=Te("0.00",Ie(a.idealFutureValue,a.value)),e},l);const s=Se(Object.entries(l).map(([e,t])=>{const[o]=e.split("|");return a(t.idealInvestment,o)}));l=Object.entries(l).reduce((e,[n,r])=>{const[i]=n.split("|");return r.proportionalizedIdealInvestment="0.00"===s?"0.00":o(((e,t,a,o=2)=>Ee(e,Pe(t,a,fe.a.DP),o))(a(r.idealInvestment,i),t,s),i),e},l),i.forEach(e=>{const t=`${e.currency}|${e.category}`,a=l[t],n=ke(a.value,a.proportionalizedIdealInvestment);e.idealFutureValue="0.00"===a.targetPercent?"0.00":o(De(n,Pe(Ee("100.00",e.targetPercent),a.targetPercent)),e.currency),e.idealInvestment=Te("0.00",Ie(e.idealFutureValue,e.value))}),l=i.reduce((e,t)=>{const a=`${t.currency}|${t.category}`,o=l[a];return o.totalAssetIdealInvestment||(o.totalAssetIdealInvestment="0.00"),o.totalAssetIdealInvestment=ke(o.totalAssetIdealInvestment,t.idealInvestment),e},l),Object.entries(l).forEach(([e,t])=>{((e,t,a,o)=>{const n=e,r=[...t].sort((e,t)=>e.idealInvestment-e.price-(t.idealInvestment-t.price)).slice(0).map(e=>({...e}));r.forEach(e=>{e.maxAffordableQuantity=Ee(e.minimum,Pe(n.proportionalizedIdealInvestment,Ee(e.price,e.minimum,fe.a.DP),0,0),null)});const i=r.reduce((e,t)=>{const a=Pe(t.maxAffordableQuantity,t.minimum,0,0),o=Ae(a,"5"),r=[];return e.forEach(e=>{for(let i=1;i<=parseInt(o,10);i+=1){const l=Ee(t.minimum,Pe(Ee(a,i.toFixed(0)),parseInt(o,10),0,0)),s=ke(e.cost,Ee(t.price,l));if(!(fe()(s).cmp(fe()(n.proportionalizedIdealInvestment))<=0))break;r.push({assets:{...e.assets,[t.code]:l},cost:s})}}),e.push(...r),e},[{assets:[],cost:"0.00"}]);i.forEach(e=>{let t="0.00";r.forEach(a=>{const o=e.assets[a.code]||"0.00",n=Ee(o,a.price),r=fe()(Ie(a.idealInvestment,n)).abs().toFixed(2);t=ke(t,r)}),e.investmentAbsDeviation=t,e.categoryInvestmentDeviation=fe()(Ie(n.proportionalizedIdealInvestment,e.cost)).abs().toFixed(2),e.score=ke(e.investmentAbsDeviation,Ee("3.50",e.categoryInvestmentDeviation))}),i.sort((e,t)=>fe()(e.score).cmp(fe()(t.score)));const l=i[0];t.forEach(e=>{e.investmentQuantity=l.assets[e.code]||"0",e.investment=Ee(e.investmentQuantity,e.price)})})(t,i.filter(t=>`${t.currency}|${t.category}`===e))});const c=Se(i.map(e=>a(e.investment,e.currency))),u=Ie(t,c);i.forEach(e=>{e.futureQuantity=ke(e.quantity,e.investmentQuantity,null)}),i.forEach(e=>{e.futureValue=Ee(e.futureQuantity,e.price)});const d=Se(i.map(e=>a(e.futureValue,e.currency)));return i.forEach(e=>{e.futurePercent="0.00"===d?"0.0000":Ee("100.00",Pe(a(e.futureValue,e.currency),d),4)}),{assets:i,totalInvestment:c,remainingAvailableValue:u,currencyCategorySummary:l}};var rt=()=>{const{user:{identityId:e}}=n.a.useContext(S),{documentDB:t}=n.a.useContext(N),[a,o]=n.a.useState(void 0),[r,i]=n.a.useState(void 0),[l,s]=n.a.useState(void 0),[c,u]=n.a.useState(void 0),[d,p]=n.a.useState(void 0),{toDefaultCurrency:m,backToAssetCurrency:g}=Ne({defaultCurrency:c,currencies:d});n.a.useEffect(()=>{t&&e?be(t,e).then(e=>{o({assets:e})}).catch(()=>{o(void 0)}):o(void 0)},[t,e]),n.a.useEffect(()=>{if(a&&a.assets&&a.assets.length&&c&&r&&m&&g){const e=nt(a,r,m,g);s(e)}else s(void 0)},[a,c,r,m,g]),n.a.useEffect(()=>{p(a?[...new Set(Object.values(a.assets).map(({currency:e})=>e))]:void 0)},[a]);const y=l&&l.assets||a&&a.assets;return Ve(n.a.Fragment,null,Ve(ot,{setDefaultCurrency:u,setAvailableValue:i},null),Ve(Le,{absolute:!1,style:{marginTop:"0.5em",marginBottom:"0.5em"}},null),y&&Ve(Ye,{component:ze,style:{width:"fit-content"}},Ve(He,{style:{tableLayout:"auto",borderCollapse:"separate",borderSpacing:"10px"}},Ve(Ze,null,Ve(et,null,Ve(Xe,{style:{border:0}}),Ve(Xe,{style:{border:0}}),Ve(Xe,{align:"center",style:{border:0}},"Posição atual"),l&&Ve(Xe,{style:{border:0}}),l&&Ve(Xe,{align:"center",style:{border:0}},"Novo aporte"),l&&Ve(Xe,{style:{border:0}}),l&&Ve(Xe,{align:"center",style:{border:0}},"Posição futura"))),Ve(Je,null,y.map(e=>Ve(et,{key:e.code},Ve(Xe,{style:{display:"contents"}},Ve(ze,{component:Ge,p:2,style:{display:"table-cell",verticalAlign:"middle"}},Ve(Ue,{container:!0},Ve(Ue,{item:!0,xs:6},Ve(at,null,e.code)),Ve(Ue,{item:!0,xs:6,align:"right"},Ve(at,{variant:"caption",color:"textSecondary"},e.currency+" "),Ve(at,{display:"inline"},""+Oe(e.price))),Ve(Ue,{item:!0,xs:12},Ve(je,{size:"small",label:e.name}))))),Ve(Xe,{style:{display:"contents"}},Ve(ze,{component:Ge,p:2,align:"center",style:{display:"table-cell",verticalAlign:"middle"}},Ve(at,{variant:"caption",color:"textSecondary"},"objetivo"),Ve(at,null,Oe(e.targetPercent)+"%"))),Ve(Xe,{style:{display:"contents"}},Ve(ze,{component:Ge,p:2,align:"center",style:{display:"table-cell",verticalAlign:"middle"}},Ve(at,{variant:"caption",display:"block"},Oe(e.quantity)+" cotas"),Ve(at,{variant:"caption",color:"textSecondary"},e.currency+" "),Ve(at,{display:"inline"},""+Oe(e.value,2)),Ve(at,{variant:"body2"},Oe(e.currentPercent)+"%"))),l&&Ve(Xe,{padding:"none",align:"center",style:{border:0}},Ve($e,null,"chevron_right")),l&&Ve(Xe,{style:{display:"contents"}},Ve(ze,{component:Ge,p:2,align:"center",elevation:"0"===e.investmentQuantity?1:6,style:{display:"table-cell",verticalAlign:"middle",..."0"!==e.investmentQuantity&&{backgroundColor:"lightblue"}}},Ve(at,{variant:"caption"},e.code),Ve(at,{style:{..."0"!==e.investmentQuantity&&{fontWeight:"bold"}}},Oe(e.investmentQuantity)+" cotas"),Ve(at,{variant:"caption",color:"textSecondary"},e.currency+" "),Ve(at,{variant:"caption"},""+Oe(e.investment,2)))),l&&Ve(Xe,{padding:"none",align:"center",style:{border:0}},Ve($e,null,"chevron_right")),l&&Ve(Xe,{style:{display:"contents"}},Ve(ze,{component:Ge,p:2,align:"center",style:{display:"table-cell",verticalAlign:"middle"}},Ve(at,{variant:"caption",display:"block"},Oe(e.futureQuantity)+" cotas"),Ve(at,{variant:"caption",color:"textSecondary"},e.currency+" "),Ve(at,{display:"inline"},""+Oe(e.futureValue,2)),Ve(at,{variant:"body2"},Oe(e.futurePercent)+"%"))))),Ve(et,null,Ve(Xe,{style:{border:0}}),Ve(Xe,{style:{border:0}}),Ve(Xe,{style:{border:0}}),l&&Ve(Xe,{style:{border:0}}),l&&Ve(Xe,{align:"center",padding:"none",style:{border:0}},Ve(ze,{component:Ge,p:2,elevation:6,align:"center"},Ve(at,{variant:"caption",color:"textSecondary",display:"block"},"aporte efetivo"),Ve(at,{variant:"caption",color:"textSecondary"},c+" "),Ve(at,{display:"inline"},""+Oe(l.totalInvestment,2)),Ve(Le,{light:!0,variant:"fullWidth"},null),Ve(at,{variant:"caption",color:"textSecondary",display:"block"},"valor restante"),Ve(at,{variant:"caption",color:"textSecondary"},c+" "),Ve(at,{display:"inline"},""+Oe(l.remainingAvailableValue,2)))),l&&Ve(Xe,{style:{border:0}}),l&&Ve(Xe,{style:{border:0}}))))))};const it=n.a.createElement,{Box:lt,Button:st,Container:ct,Dialog:ut,DialogActions:dt,DialogContent:pt,DialogTitle:mt,Grid:gt,Paper:yt,TextField:vt,Typography:ht}=l,ft=e=>{return t=e.map(e=>e.weight),Pe(Se(t),t.length);var t},bt=e=>Se(e.map(e=>e.weight)),Ct=e=>e.map(e=>e.weight).reduce((e,t)=>void 0===e?t:Ae(e,t),void 0),xt=e=>e.reduce((e,t)=>e.includes(t.currency)?e:[...e,t.currency],[]),wt=({allocations:e,updatedAllocations:t,dismissAllocationEdition:a})=>{const{showMessage:o}=n.a.useContext(h),{user:{identityId:r}}=n.a.useContext(S),{documentDB:i}=n.a.useContext(N),{updatePortofolio:l}=le(),s=()=>{a()};return it(ut,{open:!0,onClose:s,fullWidth:!0,maxWidth:"md"},it("form",{onSubmit:n=>{n.preventDefault();const s=e.map(({currency:e,category:t})=>({currency:e,category:t,weight:n.target[`weight-${e}-${t}`].value}));((e,t,a)=>{const o={TableName:"target_allocation",Key:{user_id:t},UpdateExpression:"set allocations = :allocations",ExpressionAttributeValues:{":allocations":a}};return e.update(o).promise()})(i,r,s).then(()=>{o("Pesos atualizados com sucesso"),t(s),a(),l()}).catch(e=>{o("Não foi possível alterar os pesos"),console.error("Could not update allocations",e)})}},it(mt,null,"Alterar Pesos"),it(pt,null,xt(e).map(t=>{const a=e.filter(e=>e.currency===t);return it(lt,{key:t,margin:2,style:{display:"flex",alignItems:"center"}},it(ht,{variant:"subtitle1"},t),a.map(e=>it(lt,{key:e.category,padding:1,width:e.widthPercent+"%"},it(vt,{name:`weight-${t}-${e.category}`,type:"number",defaultValue:e.weight,label:Be[e.category],variant:"outlined",fullWidth:!0,inputProps:{min:0,step:"0.01",style:{textAlign:"center"}}},null))))})),it(dt,null,it(st,{onClick:s,variant:"contained",color:"secondary"},"Cancelar"),it(st,{type:"submit",variant:"contained",color:"primary"},"Salvar"))))},kt=(e,t)=>{let a=e.map(e=>({...e,currentPercent:Se(t.filter(t=>t.category===e.category&&t.currency===e.currency).map(e=>e.currentPercent))}));const o=bt(a);a=a.map(e=>({...e,targetPercent:"0.00"===o?"0.00":Pe(Ee("100",e.weight),o,2)}));const n=xt(e),r=n.map(t=>(e=>0===e.length?"0":Te("0",Ie(ft(e),Ee((10/e.length).toFixed(2),Ct(e)))))(e.filter(e=>e.currency===t))),i=_e(r),l=_e(n.map(t=>{const a=e.filter(e=>e.currency===t);return ke(bt(a),Ee(i,a.length.toFixed(2)))}));return a=a.map(e=>{const t=Pe(Ee(n.length.toFixed(2),"100"),a.length.toFixed(2),2),o=ke(e.weight,i),r=Te("10.00","0.00"===l?t:Pe(Ee(o,"100"),l,2));return{...e,widthPercent:r}}),a};var It=()=>{const{user:{identityId:e}}=n.a.useContext(S),{documentDB:t}=n.a.useContext(N),[a,o]=n.a.useState([]),[r,i]=n.a.useState([]),[l,s]=n.a.useState([]),[c,u]=n.a.useState(!1);n.a.useEffect(()=>{t&&e?((async(e,t)=>{const a={TableName:"target_allocation",Key:{user_id:t},AttributesToGet:["allocations"]},o=await e.get(a).promise();return o.Item&&o.Item.allocations||[]})(t,e).then(e=>{o(e)}).catch(()=>{o([])}),be(t,e).then(e=>{i(e)}).catch(()=>{i([])})):(o([]),i([]))},[t,e]),n.a.useEffect(()=>{s(a&&r?kt(a,r):[])},[a,r]);const d=n.a.useCallback(()=>{u(!1)},[]),p=n.a.useCallback(e=>{o(e)},[]);return l&&0!==l.length?it(n.a.Fragment,null,it(ct,{maxWidth:!1},it(lt,{align:"center",margin:1},it(st,{onClick:()=>{u(!0)},variant:"contained"},"Alterar pesos")),xt(l).map(e=>{const t=l.filter(t=>t.currency===e);return it(lt,{key:e,margin:2,style:{display:"flex",alignItems:"center"}},it(ht,{variant:"h6"},e),t.map(e=>it(lt,{component:yt,key:e.category,padding:1,margin:1,width:e.widthPercent+"%",align:"center"},it(ht,null,Be[e.category]),it(ht,{variant:"subtitle1"},Oe(e.weight)),it(gt,{container:!0,justify:"space-evenly"},it(gt,{item:!0},it(ht,{variant:"caption"},Oe(e.currentPercent)+"%"),it(ht,{variant:"caption",display:"block",color:"textSecondary"},"atual")),it(gt,{item:!0},it(ht,{variant:"caption"},Oe(e.targetPercent)+"%"),it(ht,{variant:"caption",display:"block",color:"textSecondary"},"objetivo"))))))})),c&&it(wt,{allocations:l,updatedAllocations:p,dismissAllocationEdition:d},null)):null};const Et=n.a.createElement,{Box:Pt,Button:Tt,Dialog:St,DialogActions:Dt,DialogContent:At,DialogTitle:_t,DialogContentText:Nt,FormControl:Ot,InputLabel:Bt,Grid:Ft,MenuItem:Mt,Paper:Vt,Select:zt,Table:Rt,TableBody:jt,TableCell:Lt,TableContainer:$t,TableHead:Wt,TableRow:Ut,TextField:qt}=l,Qt=({selectedAsset:e,allAssetCodes:t,assetChanged:a,dismissAssetEdition:o})=>{const{showMessage:r}=n.a.useContext(h),{user:{identityId:i}}=n.a.useContext(S),{documentDB:l}=n.a.useContext(N),[s,c]=n.a.useState(!1),{updateTargetAllocation:u,updatePosition:d}=le(),p=null===e.code,m=()=>{o()};return e?Et(St,{open:!0,onClose:m},Et("form",{onSubmit:t=>{t.preventDefault();const n={currency:t.target.currency.value,category:t.target.category.value,name:t.target.name.value,minimum:t.target.minimum.value,weight:t.target.weight.value},s=p?t.target.code.value:e.code;(async(e,t,a,o)=>{const n={TableName:"asset",Key:{user_id:t},UpdateExpression:"set assets.#assetCode = :asset",ExpressionAttributeNames:{"#assetCode":a},ExpressionAttributeValues:{":asset":o}};try{return await e.update(n).promise()}catch(n){if(n.message&&"The document path provided in the update expression is invalid for update"===n.message){const n={TableName:"asset",Key:{user_id:t},UpdateExpression:"set assets = :assets",ExpressionAttributeValues:{":assets":{[a]:o}}};return e.update(n).promise()}throw n}})(l,i,s,n).then(()=>{r(`Ativo ${p?"adicionado":"atualizado"} com sucesso`),a({code:s,...n},p?"DB_INSERT":"DB_UPDATE"),o(),u(),d()}).catch(e=>{r(`Não foi possível ${p?"adicionar":"atualizar"} o ativo`),console.error(`Could not ${p?"add":"update"} asset`,e)})}},Et(_t,null,""+(p?"Adicionar ativo":"Editar ativo: "+e.code)),Et(At,null,Et(Ft,{container:!0,spacing:2},p&&Et(Ft,{item:!0,xs:6},Et(qt,{name:"code",defaultValue:"",label:"Código",required:!0,variant:"filled",fullWidth:!0,onChange:e=>{e.target.setCustomValidity(t.includes(e.target.value)?"Código já existente":""),e.target.reportValidity()}},null)),Et(Ft,{item:!0,xs:2},Et(Ot,{fullWidth:!0},Et(Bt,{id:"currency-label"},"Moeda"),Et(zt,{name:"currency",defaultValue:e.currency,labelId:"currency-label",required:!0,variant:"filled"},Me.map(e=>Et(Mt,{key:e,value:e},e))))),Et(Ft,{item:!0,xs:4},Et(Ot,{fullWidth:!0},Et(Bt,{id:"category-label"},"Categoria"),Et(zt,{name:"category",defaultValue:e.category||"",labelId:"category-label",required:!0,variant:"filled"},Object.entries(Be).map(([e,t])=>Et(Mt,{key:e,value:e},t))))),Et(Ft,{item:!0,xs:6},Et(qt,{name:"name",defaultValue:e.name,label:"Nome",required:!0,variant:"filled",fullWidth:!0},null)),Et(Ft,{item:!0,xs:4},Et(qt,{name:"minimum",type:"number",defaultValue:e.minimum,label:"Qtd mínima",required:!0,variant:"filled",fullWidth:!0,inputProps:{min:0,step:"0.00000000000001",style:{textAlign:"right"}}},null)),Et(Ft,{item:!0,xs:2},Et(qt,{name:"weight",type:"number",defaultValue:e.weight,label:"Peso",required:!0,variant:"filled",fullWidth:!0,inputProps:{min:0,step:"0.01",style:{textAlign:"right"}}},null)))),Et(Dt,null,Et(Pt,{style:{flex:"auto"}},!p&&Et(Tt,{onClick:()=>c(!0),variant:"outlined",color:"secondary"},"Excluir"),s&&Et(St,{open:!0,onClose:()=>c(!1)},Et(At,null,Et(Nt,null,`Confirma exclusão do ativo ${e.code}?`)),Et(Dt,null,Et(Tt,{onClick:()=>c(!1)},"Não"),Et(Tt,{onClick:()=>{((e,t,a)=>{const o={TableName:"asset",Key:{user_id:t},UpdateExpression:"REMOVE assets.#assetCode",ExpressionAttributeNames:{"#assetCode":a}};return e.update(o).promise()})(l,i,e.code).then(()=>{r("Ativo excluído com sucesso"),a(e,"DB_DELETE"),o(),u(),d()}).catch(e=>{r("Não foi possível excluir o ativo"),console.error("Could not delete asset",e)})},autoFocus:!0},"Sim")))),Et(Tt,{onClick:m,variant:"contained",color:"secondary"},"Cancelar"),Et(Tt,{type:"submit",variant:"contained",color:"primary"},"Salvar")))):null},Gt=e=>e.sort((e,t)=>e.code.localeCompare(t.code)).sort((e,t)=>e.category.localeCompare(t.category)).sort((e,t)=>e.currency.localeCompare(t.currency));var Kt=()=>{const{user:{identityId:e}}=n.a.useContext(S),{documentDB:t}=n.a.useContext(N),[a,o]=n.a.useState([]),[r,i]=n.a.useState(),s=l.useTheme();n.a.useEffect(()=>{t&&e?Ce(t,e).then(e=>{o(Gt(Object.entries(e).map(([e,t])=>({code:e,...t}))))}).catch(()=>{o([])}):o([])},[t,e]);const c=n.a.useCallback(()=>{i(void 0)},[]),u=n.a.useCallback((e,t)=>{"DB_INSERT"===t?o(t=>Gt([...t,e])):"DB_UPDATE"===t?o(t=>Gt(t.map(t=>t.code===e.code?e:t))):"DB_DELETE"===t&&o(t=>t.filter(t=>t.code!==e.code))},[]);return Et(n.a.Fragment,null,Et(Pt,{margin:1},Et(Tt,{onClick:()=>{i({code:null})},variant:"contained"},"Novo ativo")),a&&0!==a.length?Et($t,{component:Vt,style:{width:"fit-content"}},Et(Rt,{style:{tableLayout:"auto"}},Et(Wt,{style:{backgroundColor:s.palette.background.default}},Et(Ut,null,Et(Lt,null,"Moeda"),Et(Lt,null,"Categoria"),Et(Lt,null,"Código"),Et(Lt,null,"Nome"),Et(Lt,{align:"right"},"Qtd mínima"),Et(Lt,{align:"right"},"Peso"))),Et(jt,null,a.map(e=>Et(Ut,{key:e.code,hover:!0,onClick:()=>(e=>{i(e)})(e)},Et(Lt,null,e.currency),Et(Lt,null,Be[e.category]),Et(Lt,null,e.code),Et(Lt,null,e.name),Et(Lt,{align:"right"},Oe(e.minimum)),Et(Lt,{align:"right"},Oe(e.weight))))))):null,r&&Et(Qt,{selectedAsset:r,allAssetCodes:a.map(({code:e})=>e),assetChanged:u,dismissAssetEdition:c},null))},Ht=a(5),Jt=a.n(Ht);const Xt=n.a.createElement,{Box:Yt,Button:Zt,Dialog:ea,DialogActions:ta,DialogContent:aa,DialogTitle:oa,DialogContentText:na,FormControl:ra,InputLabel:ia,Grid:la,MenuItem:sa,Paper:ca,Select:ua,Table:da,TableBody:pa,TableCell:ma,TableContainer:ga,TableHead:ya,TableRow:va,TextField:ha}=l,fa=e=>e.sort((e,t)=>t.type.localeCompare(e.type)).sort((e,t)=>t.code.localeCompare(e.code)).sort((e,t)=>t.date.localeCompare(e.date)),ba=({selectedOperation:e,operationChanged:t,dismissOperationEdition:a,assets:o})=>{const{showMessage:r}=n.a.useContext(h),{user:{identityId:i}}=n.a.useContext(S),{documentDB:l}=n.a.useContext(N),[s,c]=n.a.useState(!1),[u,d]=n.a.useState(),[p,m]=n.a.useState(),{updatePosition:g}=le(),y=null===e.operationId,v=n.a.useCallback(e=>{const t=Object.keys(o).includes(e)?o[e].minimum:"1";d(t),m(parseFloat(t)<1?t:"0.01")},[o]);n.a.useEffect(()=>{v(e.code)},[e.code,v]);const f=()=>{a()};return Xt(ea,{open:!0,onClose:f},Xt("form",{onSubmit:o=>{o.preventDefault();const n={type:o.target.type.value,code:o.target.code.value,date:o.target.date.value,amount:o.target.amount.value,price:o.target.price.value,expenses:o.target.expenses.value},s=y?Jt()():e.operationId;(async(e,t,a,o)=>{const n={TableName:"operation",Key:{user_id:t},UpdateExpression:"set operations.#operationId = :operation",ExpressionAttributeNames:{"#operationId":a},ExpressionAttributeValues:{":operation":o}};try{return await e.update(n).promise()}catch(n){if(n.message&&"The document path provided in the update expression is invalid for update"===n.message){const n={TableName:"operation",Key:{user_id:t},UpdateExpression:"set operations = :operations",ExpressionAttributeValues:{":operations":{[a]:o}}};return e.update(n).promise()}throw n}})(l,i,s,n).then(()=>{r(`Operação ${y?"adicionada":"atualizada"} com sucesso`),t({operationId:s,...n},y?"DB_INSERT":"DB_UPDATE"),a(),g()}).catch(e=>{r(`Não foi possível ${y?"adicionar":"atualizar"} a operação`),console.error(`Could not ${y?"add":"update"} operation`,e)})}},Xt(oa,null,(y?"Adicionar":"Editar")+" operação"),Xt(aa,null,Xt(la,{container:!0,spacing:2},Xt(la,{item:!0,xs:3},Xt(ra,{fullWidth:!0},Xt(ia,{id:"type-label"},"Tipo"),Xt(ua,{name:"type",defaultValue:e.type||"",labelId:"type-label",required:!0,variant:"filled"},Object.entries(Fe).map(([e,t])=>Xt(sa,{key:e,value:e},t))))),Xt(la,{item:!0,xs:5},Xt(ha,{name:"code",defaultValue:e.code,label:"Código",required:!0,variant:"filled",fullWidth:!0,onChange:e=>{e.target.setCustomValidity(Object.keys(o).includes(e.target.value)?"":"Código inexistente"),v(e.target.value)}},null)),Xt(la,{item:!0,xs:4},Xt(ha,{name:"date",type:"date",defaultValue:e.date,label:"Data",InputLabelProps:{shrink:!0},required:!0,variant:"filled",fullWidth:!0},null)),Xt(la,{item:!0,xs:12},Xt(ha,{name:"amount",type:"number",defaultValue:e.amount,label:"Quantidade",required:!0,variant:"filled",fullWidth:!0,inputProps:{min:0,step:u,style:{textAlign:"right"}}},null)),Xt(la,{item:!0,xs:12},Xt(ha,{name:"price",type:"number",defaultValue:e.price,label:"Preço",required:!0,variant:"filled",fullWidth:!0,inputProps:{min:0,step:p,style:{textAlign:"right"}}},null)),Xt(la,{item:!0,xs:12},Xt(ha,{name:"expenses",type:"number",defaultValue:e.expenses,label:"Despesas",required:!0,variant:"filled",fullWidth:!0,inputProps:{min:0,step:p,style:{textAlign:"right"}}},null)))),Xt(ta,null,Xt(Yt,{style:{flex:"auto"}},!y&&Xt(Zt,{onClick:()=>c(!0),variant:"outlined",color:"secondary"},"Excluir"),s&&Xt(ea,{open:!0,onClose:()=>c(!1)},Xt(aa,null,Xt(na,null,"Confirma exclusão da operação?")),Xt(ta,null,Xt(Zt,{onClick:()=>c(!1)},"Não"),Xt(Zt,{onClick:()=>{((e,t,a)=>{const o={TableName:"operation",Key:{user_id:t},UpdateExpression:"REMOVE operations.#operationId",ExpressionAttributeNames:{"#operationId":a}};return e.update(o).promise()})(l,i,e.operationId).then(()=>{r("Operação excluída com sucesso"),t(e,"DB_DELETE"),a(),g()}).catch(e=>{r("Não foi possível excluir a operação"),console.error("Could not delete operation",e)})},autoFocus:!0},"Sim")))),Xt(Zt,{onClick:f,variant:"contained",color:"secondary"},"Cancelar"),Xt(Zt,{type:"submit",variant:"contained",color:"primary"},"Salvar"))))};var Ca=()=>{const{user:{identityId:e}}=n.a.useContext(S),{documentDB:t}=n.a.useContext(N),[a,o]=n.a.useState([]),[r,i]=n.a.useState([]),[l,s]=n.a.useState(30),[c,u]=n.a.useState();n.a.useEffect(()=>{t&&e?((async(e,t)=>{const a={TableName:"operation",Key:{user_id:t},AttributesToGet:["operations"]},o=await e.get(a).promise();return o.Item&&o.Item.operations||{}})(t,e).then(e=>{i(fa(Object.entries(e).map(([e,t])=>({operationId:e,...t}))))}).catch(e=>{console.error("Could not retrieve operations",e),i([])}),Ce(t,e).then(e=>{o(e)}).catch(e=>{console.error("Could not retrieve assets",e),o([])})):(i([]),o([]))},[t,e]);const d=n.a.useCallback(()=>{u(void 0)},[]),p=n.a.useCallback((e,t)=>{"DB_INSERT"===t?i(t=>fa([...t,e])):"DB_UPDATE"===t?i(t=>fa(t.map(t=>t.operationId===e.operationId?e:t))):"DB_DELETE"===t&&i(t=>t.filter(t=>t.operationId!==e.operationId))},[]);return Xt(n.a.Fragment,null,Xt(Yt,{margin:1},Xt(Zt,{onClick:()=>{u({operationId:null})},variant:"contained"},"Nova operação")),r&&r.length>0&&Xt(ga,{component:ca,style:{width:"fit-content",maxHeight:"600px"},onScroll:e=>{e.target.scrollTop+e.target.clientHeight===e.target.scrollHeight&&s(e=>Math.min(r.length,e+30))}},Xt(da,{stickyHeader:!0,style:{tableLayout:"auto"}},Xt(ya,null,Xt(va,null,Xt(ma,null,"Tipo"),Xt(ma,null,"Código"),Xt(ma,null,"Data"),Xt(ma,{align:"right"},"Quantidade"),Xt(ma,{align:"right"},"Preço"),Xt(ma,{align:"right"},"Despesas"))),Xt(pa,null,r.slice(0,l).map(e=>{return Xt(va,{key:e.operationId,hover:!0,onClick:()=>(e=>{u(e)})(e)},Xt(ma,null,Fe[e.type]),Xt(ma,null,e.code),Xt(ma,null,(t=e.date,new Date(t).toLocaleDateString())),Xt(ma,{align:"right"},Oe(e.amount)),Xt(ma,{align:"right"},Oe(e.price)),Xt(ma,{align:"right"},Oe(e.expenses)));var t})))),l>30&&l<r.length&&Xt(Yt,{margin:1},Xt(Zt,{onClick:()=>{s(r.length)}},"Exibir todas")),c&&Xt(ba,{selectedOperation:c,operationChanged:p,dismissOperationEdition:d,assets:a},null))};const xa=n.a.createElement,{Button:wa,Grid:ka}=l;var Ia=()=>{const{updatePosition:e,updatePortofolio:t}=le();return xa(ka,{container:!0,spacing:1},xa(ka,{item:!0},xa(wa,{variant:"contained",onClick:()=>{e()},disabled:!e},"Atualizar Posição")),xa(ka,{item:!0},xa(wa,{variant:"contained",onClick:()=>{t()},disabled:!t},"Atualizar Portfólio")))};const Ea=n.a.createElement,{Button:Pa}=l;var Ta=[{name:"main",label:"Main",path:"/",hideFromMenu:!0,component:ue,options:{exact:!0}},{name:"target-allocation",label:"Macro-Alocação",path:"/target-allocation",component:It},{name:"assets",label:"Meus Ativos",path:"/assets",component:Kt},{name:"suggestedAllocation",label:"Novo Aporte",path:"/suggested-allocation",component:rt},{name:"operations",label:"Registro de Operações",path:"/operations",component:Ca},{name:"update-allocation",label:"Atualização do Portfólio",path:"/update-allocation",authorizedGroups:["admin"],component:Ia},{name:"upload-prices",label:"Upload Prices",path:"/upload-prices",authorizedGroups:["admin"],component:()=>{const{showMessage:e}=n.a.useContext(h),{invokeLambda:t}=n.a.useContext(M),a=n.a.useRef(),{updatePortofolio:o}=le(),r=a=>{const n=a.target.result;let r;try{r=n.split(/\r\n|\n/).slice(1).map(e=>[...e.matchAll(/"[^"]*"|[^,]+/g)]).reduce((e,t)=>{const[a,o]=t.map(e=>e[0]).map(e=>e.replace(/^"(.*)"$/,"$1")).map(e=>e.replace(",","."));return e[a]=o,e},{})}catch(t){e("Não foi possível carregar o arquivo"),console.error("File loading failed",t)}r&&t("update_prices",{prices:r}).then(()=>{e("Preços atualizados com sucesso"),o()}).catch(t=>{e("Não foi possível atualizar os preços"),console.error("Prices update failed",t)})};return Ea("form",{ref:a},Ea("input",{id:"contained-button-file",accept:".csv",type:"file",style:{display:"none"},onChange:e=>{const t=new FileReader;t.onload=r,t.onloadend=()=>a.current.reset(),t.readAsText(e.target.files[0])},disabled:!t},null),Ea("label",{htmlFor:"contained-button-file"},Ea(Pa,{disabled:!t,variant:"contained",color:"primary",component:"span"},"Upload Preços Atualizados")))}},{name:"authentication",label:"Athentication",path:"/authentication/:authorization_code",hideFromMenu:!0,component:ve}];const Sa=n.a.createElement,{HashRouter:Da,Route:Aa,Switch:_a}=window.ReactRouterDOM,{Toolbar:Na}=l,Oa=({children:e})=>Sa(u,null,Sa(v,null,Sa(T,null,Sa(_,null,Sa(F,null,e)))));if("/my-investment-wallet/"===window.location.pathname){const e=new URLSearchParams(window.location.search);null!==e.get("auth-redirect")&&null!==e.get("code")&&window.history.replaceState({},"","/my-investment-wallet/#/authentication/"+e.get("code"))}i.a.render(Sa(()=>{const[e,t]=n.a.useState(!1);return Sa(Oa,null,Sa(Da,null,Sa(J,{setDrawerOpen:t,routes:Ta},null),Sa(ie,{routes:Ta,drawerOpen:e,setDrawerOpen:t}),Sa(Na,null,null),Sa(_a,null,Ta.map(e=>Sa(Aa,{key:e.name+"-route",path:e.path,...e.options},Sa(e.component))))))},null,null),document.getElementById("app_container"))}]);